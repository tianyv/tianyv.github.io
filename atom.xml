<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LaiTao&#39;s blog</title>
  <subtitle>管理不在于知，而在于行！</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://github.com/tianyv/tianyv.github.io/"/>
  <updated>2017-04-03T15:48:03.232Z</updated>
  <id>https://github.com/tianyv/tianyv.github.io/</id>
  
  <author>
    <name>赖 韬</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Win32::PPT模块自动化报告</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2017/04/03/mooseppt/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2017/04/03/mooseppt/</id>
    <published>2017-04-03T15:29:03.000Z</published>
    <updated>2017-04-03T15:48:03.232Z</updated>
    
    <content type="html"><![CDATA[<p>利用MooseX::NonMoose::InsideOut继承非Moose模块Win32::PowerPoint。<br><a id="more"></a></p>
<h2 id="一、依赖模块">一、依赖模块</h2><h4 id="1-1模块Win32::PPT">1.1模块Win32::PPT</h4><ul>
<li>Moose;</li>
<li>Win32::OLE;</li>
<li>MooseX::NonMoose::InsideOut;</li>
</ul>
<h4 id="1-2示例main">1.2示例main</h4><ul>
<li>Cwd;</li>
<li>File::Spec;</li>
<li>YAML::Syck;</li>
<li>Data::Printer;</li>
</ul>
<h2 id="二、说明">二、说明</h2><ul>
<li>文件名为“模板.ppt”的PPT与win32ppt.pl放在同一文件夹下</li>
<li>子文件夹img下放2个图片“3D.png”与“jx.png”</li>
<li>config.yaml为配置文件，用于预设标题、正文和图片的相关属性；可由!yjconfig.pl生成</li>
</ul>
<h2 id="三、使用步骤">三、使用步骤</h2><ul>
<li>Win32::PPT-&gt;new();</li>
<li>$ppt-&gt;{config} = LoadFile($confile);</li>
<li>new_ppt()or open_ppt();</li>
<li>新建幻灯片<ul>
<li>标题与正文：slide2TB()</li>
<li>标题与图片：slide2TP()</li>
<li>标题、正文与图片（左右两列或上下两行格式）：slide2TBBPP()</li>
</ul>
</li>
<li>save_ppt()</li>
</ul>
<h2 id="四、Code">四、Code</h2><h4 id="4-1_win32ppt-pl">4.1 win32ppt.pl</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Win32::PPT;</span><br><span class="line"><span class="keyword">use</span> Moose;</span><br><span class="line"><span class="keyword">use</span> Win32::OLE;</span><br><span class="line"><span class="keyword">use</span> MooseX::NonMoose::InsideOut;</span><br><span class="line"><span class="keyword">use</span> Data::Printer;</span><br><span class="line"></span><br><span class="line">extends <span class="string">'Win32::PowerPoint'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$intro</span>=&lt;&lt;<span class="string">'EOF'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################</span></span><br><span class="line"><span class="comment">#                   Win32::PPT模块</span></span><br><span class="line"><span class="comment">#      Author: TianYv</span></span><br><span class="line"><span class="comment">#      Blog: http://tianyv.github.io</span></span><br><span class="line"><span class="comment">#      Blog: http://blog.chinaunix.net/uid/22674875.html</span></span><br><span class="line"><span class="comment">########################################################</span></span><br><span class="line">EOF</span><br><span class="line">p <span class="variable">$intro</span>;</span><br><span class="line"></span><br><span class="line">has <span class="string">config =&gt;</span> (</span><br><span class="line">    <span class="string">is      =&gt;</span> <span class="string">'rw'</span>,</span><br><span class="line">    <span class="string">default =&gt;</span> <span class="sub"><span class="keyword">sub</span> &#123;</span> &#123;&#125; &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">has <span class="string">app =&gt;</span> ( <span class="string">is =&gt;</span> <span class="string">'rw'</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">#通过PPT vba增加打开方法</span></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> open_ppt &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$self</span>, <span class="variable">$file</span> ) = <span class="variable">@_</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">unless</span> <span class="keyword">defined</span> <span class="variable">$file</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$self</span>-&gt;&#123;app&#125; = Win32::OLE-&gt;GetActiveObject(<span class="string">'PowerPoint.Application'</span>);</span><br><span class="line">    <span class="variable">$self</span>-&gt;&#123;app&#125;-&gt;&#123;Visible&#125; = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$objppt</span> = <span class="variable">$self</span>-&gt;&#123;app&#125;-&gt;Presentations-&gt;Open(<span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#重写创建PPT方法</span></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> new_ppt &#123;</span></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$self</span> = <span class="keyword">shift</span>;</span><br><span class="line">    <span class="variable">$self</span>-&gt;new_presentation(</span><br><span class="line">        <span class="string">background_forecolor =&gt;</span> [ <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span> ],</span><br><span class="line">        <span class="string">background_backcolor =&gt;</span> <span class="string">'RGB(255,255,255)'</span>,</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#新建幻灯片，并输入Title和Body文字</span></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> slide2TB &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$self</span>, <span class="variable">$texTitle</span>, <span class="variable">$texBody</span>, <span class="variable">$hT</span>, <span class="variable">$hB</span> ) = <span class="variable">@_</span>;</span><br><span class="line">    <span class="variable">$hT</span> = <span class="keyword">ref</span>(<span class="variable">$hT</span>) eq <span class="string">'HASH'</span> ? <span class="variable">$hT</span> : <span class="variable">$self</span>-&gt;&#123;config&#125;-&gt;&#123;title&#125;;</span><br><span class="line">    <span class="variable">$hB</span> = <span class="keyword">ref</span>(<span class="variable">$hB</span>) eq <span class="string">'HASH'</span> ? <span class="variable">$hB</span> : <span class="variable">$self</span>-&gt;&#123;config&#125;-&gt;&#123;body&#125;;</span><br><span class="line">    <span class="variable">$self</span>-&gt;new_slide();</span><br><span class="line">    <span class="variable">$self</span>-&gt;add_text( <span class="variable">$texTitle</span>, <span class="variable">$hT</span> );</span><br><span class="line">    <span class="variable">$self</span>-&gt;add_text( <span class="variable">$texBody</span>,  <span class="variable">$hB</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#新建幻灯片，并输入Title和Picture文字</span></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> slide2TP &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$self</span>, <span class="variable">$texTitle</span>, <span class="variable">$img</span>, <span class="variable">$hT</span>, <span class="variable">$hP</span> ) = <span class="variable">@_</span>;</span><br><span class="line">    <span class="variable">$hT</span> = <span class="keyword">ref</span>(<span class="variable">$hT</span>) eq <span class="string">'HASH'</span> ? <span class="variable">$hT</span> : <span class="variable">$self</span>-&gt;&#123;config&#125;-&gt;&#123;title&#125;;</span><br><span class="line">    <span class="variable">$hP</span> = <span class="keyword">ref</span>(<span class="variable">$hP</span>) eq <span class="string">'HASH'</span> ? <span class="variable">$hP</span> : <span class="variable">$self</span>-&gt;&#123;config&#125;-&gt;&#123;picture&#125;;</span><br><span class="line">    <span class="variable">$self</span>-&gt;new_slide();</span><br><span class="line">    <span class="variable">$self</span>-&gt;add_text( <span class="variable">$texTitle</span>, <span class="variable">$hT</span> );</span><br><span class="line">    <span class="variable">$self</span>-&gt;add_picture( <span class="variable">$img</span>, <span class="variable">$hP</span> );</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#$hash=&#123;texT=&gt;,texB=&gt;,img=&gt;,type=&gt;&#125;</span></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> slide2TBBPP &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$self</span>, <span class="variable">$hash</span>, <span class="variable">$hT</span>, <span class="variable">$hB</span>, <span class="variable">$hP</span> ) = <span class="variable">@_</span>;</span><br><span class="line">    <span class="variable">$hT</span> = <span class="keyword">ref</span>(<span class="variable">$hT</span>) eq <span class="string">'HASH'</span> ? <span class="variable">$hT</span> : <span class="variable">$self</span>-&gt;&#123;config&#125;-&gt;&#123;def_tbp&#125;-&gt;&#123;title&#125;;</span><br><span class="line">    <span class="variable">$hB</span> = <span class="keyword">ref</span>(<span class="variable">$hB</span>) eq <span class="string">'HASH'</span> ? <span class="variable">$hB</span> : <span class="variable">$self</span>-&gt;&#123;config&#125;-&gt;&#123;def_tbp&#125;-&gt;&#123;body&#125;;</span><br><span class="line">    <span class="variable">$hP</span> = <span class="keyword">ref</span>(<span class="variable">$hP</span>) eq <span class="string">'HASH'</span> ? <span class="variable">$hP</span> : <span class="variable">$self</span>-&gt;&#123;config&#125;-&gt;&#123;def_tbp&#125;-&gt;&#123;picture&#125;;</span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$texTitle</span>, <span class="variable">$texBody</span>, <span class="variable">$img</span> );</span><br><span class="line">    <span class="keyword">if</span> ( <span class="keyword">ref</span>(<span class="variable">$hash</span>) eq <span class="string">'HASH'</span> ) &#123;</span><br><span class="line">        <span class="variable">$texTitle</span> = <span class="keyword">defined</span>( <span class="variable">$hash</span>-&gt;&#123;texT&#125; ) ? <span class="variable">$hash</span>-&gt;&#123;texT&#125; : <span class="string">'标题定义错误！'</span>;</span><br><span class="line">        <span class="variable">$texBody</span>  = <span class="keyword">defined</span>( <span class="variable">$hash</span>-&gt;&#123;texB&#125; ) ? <span class="variable">$hash</span>-&gt;&#123;texB&#125; : <span class="string">'正文定义错误！'</span>;</span><br><span class="line">        <span class="variable">$img</span>      = <span class="keyword">defined</span>( <span class="variable">$hash</span>-&gt;&#123;img&#125; )  ? <span class="variable">$hash</span>-&gt;&#123;img&#125;  : <span class="string">''</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$self</span>-&gt;new_slide();</span><br><span class="line">    <span class="variable">$self</span>-&gt;add_text( <span class="variable">$texTitle</span>, <span class="variable">$hT</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$type</span> = <span class="variable">$hash</span>-&gt;&#123;type&#125;;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="variable">$type</span> == <span class="number">1</span> ) &#123;</span><br><span class="line">        <span class="variable">$self</span>-&gt;add_text( <span class="variable">$texBody</span>, <span class="variable">$hB</span> );</span><br><span class="line">        <span class="variable">$self</span>-&gt;add_picture( <span class="variable">$img</span>, <span class="variable">$hP</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$self</span>-&gt;add_picture( <span class="variable">$img</span>, <span class="variable">$hP</span> );</span><br><span class="line">        <span class="variable">$self</span>-&gt;add_text( <span class="variable">$texBody</span>, <span class="variable">$hB</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#重写创建PPT保存并关闭方法，保存在当前文件夹</span></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> save_ppt &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$self</span>, <span class="variable">$name</span> ) = <span class="variable">@_</span>;</span><br><span class="line">    <span class="variable">$self</span>-&gt;save_presentation(<span class="variable">$name</span>);</span><br><span class="line">    <span class="variable">$self</span>-&gt;close_presentation();</span><br><span class="line">    <span class="variable">$self</span>-&gt;quit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"><span class="keyword">use</span> File::Spec;</span><br><span class="line"><span class="keyword">use</span> YAML::Syck;</span><br><span class="line"><span class="keyword">use</span> Data::Printer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$ppt</span>  = Win32::PPT-&gt;new();</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$dir</span>  = Cwd::getcwd();</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$file</span> = <span class="variable">$dir</span> . <span class="string">'/模板.ppt'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取配置文件config.yaml信息：设置(title body picture)位置；</span></span><br><span class="line"><span class="comment">#设置字体名称[name]、字体大小[size]、字体是否加粗[bold]、图片宽高[width | hight]</span></span><br><span class="line"><span class="comment">#如$ppt-&gt;&#123;config&#125;-&gt;&#123;body&#125;-&gt;&#123;size&#125; 为正文字体大小</span></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$confile</span> = File::Spec-&gt;rel2abs(<span class="string">'config.yaml'</span>);</span><br><span class="line"><span class="variable">$ppt</span>-&gt;&#123;config&#125; = LoadFile(<span class="variable">$confile</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#p $ppt-&gt;&#123;config&#125;;</span></span><br><span class="line"><span class="comment">#$ppt-&gt;new_ppt();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#打开模版PPT</span></span><br><span class="line"><span class="variable">$ppt</span>-&gt;open_ppt(<span class="variable">$file</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.1使用config.yaml内设的默认属性</span></span><br><span class="line"><span class="variable">$ppt</span>-&gt;slide2TB( <span class="string">'一、测试标题'</span>, <span class="string">'测试正文'</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.2可以改变局部属性，如$ht ，也可像$hb一样更改所有属性</span></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$ht</span> = &#123;</span><br><span class="line">    <span class="string">top  =&gt;</span> <span class="number">40</span>,</span><br><span class="line">    <span class="string">size =&gt;</span> <span class="number">24</span>,</span><br><span class="line">    <span class="string">name =&gt;</span> <span class="string">'楷体'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$hb</span> = &#123;</span><br><span class="line">    <span class="string">left   =&gt;</span> <span class="number">35</span>,</span><br><span class="line">    <span class="string">top    =&gt;</span> <span class="number">85</span>,</span><br><span class="line">    <span class="string">width  =&gt;</span> <span class="number">625</span>,</span><br><span class="line">    <span class="string">height =&gt;</span> <span class="number">400</span>,</span><br><span class="line">    <span class="string">size   =&gt;</span> <span class="number">24</span>,</span><br><span class="line">    <span class="string">bold   =&gt;</span> <span class="number">1</span>,</span><br><span class="line">    <span class="string">name   =&gt;</span> <span class="string">'宋体'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable">$ppt</span>-&gt;slide2TB( <span class="string">'一、测试标题'</span>, <span class="string">'测试正文'</span>, <span class="variable">$ht</span>, <span class="variable">$hb</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.1使用config.yaml内设的默认属性;插入图片</span></span><br><span class="line"><span class="variable">$ppt</span>-&gt;slide2TP( <span class="string">'二、测试标题图片'</span>, <span class="string">'img/jx.png'</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.2更改图片局部属性</span></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$hp</span> = &#123;</span><br><span class="line">    <span class="string">width  =&gt;</span> <span class="number">200</span>,</span><br><span class="line">    <span class="string">height =&gt;</span> <span class="number">130</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable">$ppt</span>-&gt;slide2TP( <span class="string">'二、测试标题图片'</span>, <span class="string">'img/jx.png'</span>, <span class="variable">$ht</span>, <span class="variable">$hp</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.1左右2列的幻灯片,type=1,左正文+右图片</span></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$h1</span> = &#123;</span><br><span class="line">    <span class="string">texT =&gt;</span> <span class="string">'三、左正文+右图片'</span>,</span><br><span class="line">    <span class="string">texB =&gt;</span> <span class="string">'1234567890正文'</span>,</span><br><span class="line">    <span class="string">img  =&gt;</span> <span class="string">'img/3D.png'</span>,</span><br><span class="line">    <span class="string">type =&gt;</span> <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable">$ppt</span>-&gt;slide2TBBPP(<span class="variable">$h1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.2上下2列的幻灯片,type=0,上图片+下正文</span></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$h2</span> = &#123;</span><br><span class="line">    <span class="string">texT =&gt;</span> <span class="string">'三、上图片+下正文'</span>,</span><br><span class="line">    <span class="string">texB =&gt;</span> <span class="string">'1234567890正文'</span>,</span><br><span class="line">    <span class="string">img  =&gt;</span> <span class="string">'img/3D.png'</span>,</span><br><span class="line">    <span class="string">type =&gt;</span> <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$hb2</span> = &#123;</span><br><span class="line">    <span class="string">top    =&gt;</span> <span class="number">450</span>,</span><br><span class="line">    <span class="string">height =&gt;</span> <span class="number">200</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$hp2</span> = &#123;</span><br><span class="line">    <span class="string">top    =&gt;</span> <span class="number">85</span>,</span><br><span class="line">    <span class="string">width  =&gt;</span> <span class="number">400</span>,</span><br><span class="line">    <span class="string">height =&gt;</span> <span class="number">360</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable">$ppt</span>-&gt;slide2TBBPP( <span class="variable">$h2</span>, <span class="variable">$ht</span>, <span class="variable">$hb2</span>, <span class="variable">$hp2</span> );</span><br><span class="line"><span class="variable">$ppt</span>-&gt;save_ppt(<span class="string">"结果.ppt"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="4-2_!yjconfig-pl">4.2 !yjconfig.pl</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MyConfig;</span><br><span class="line"><span class="keyword">use</span> Moo;</span><br><span class="line"><span class="keyword">use</span> YAML::Tiny;</span><br><span class="line"></span><br><span class="line">has <span class="string">file =&gt;</span> ( <span class="string">is =&gt;</span> <span class="string">'rw'</span> );</span><br><span class="line"></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> SetConf &#123;</span></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$self</span> = <span class="keyword">shift</span>;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">%h</span>    = (</span><br><span class="line">        <span class="string">'title'</span> =&gt; &#123;</span><br><span class="line">            <span class="string">left   =&gt;</span> <span class="number">35</span>,</span><br><span class="line">            <span class="string">top    =&gt;</span> <span class="number">40</span>,</span><br><span class="line">            <span class="string">width  =&gt;</span> <span class="number">625</span>,</span><br><span class="line">            <span class="string">height =&gt;</span> <span class="number">50</span>,</span><br><span class="line">            <span class="string">size   =&gt;</span> <span class="number">24</span>,</span><br><span class="line">            <span class="string">bold   =&gt;</span> <span class="number">1</span>,</span><br><span class="line">            <span class="string">name   =&gt;</span> <span class="string">'宋体'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'body'</span> =&gt; &#123;</span><br><span class="line">            <span class="string">left   =&gt;</span> <span class="number">35</span>,</span><br><span class="line">            <span class="string">top    =&gt;</span> <span class="number">85</span>,</span><br><span class="line">            <span class="string">width  =&gt;</span> <span class="number">625</span>,</span><br><span class="line">            <span class="string">height =&gt;</span> <span class="number">400</span>,</span><br><span class="line">            <span class="string">size   =&gt;</span> <span class="number">24</span>,</span><br><span class="line">            <span class="string">bold   =&gt;</span> <span class="number">0</span>,</span><br><span class="line">            <span class="string">name   =&gt;</span> <span class="string">'宋体'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'picture'</span> =&gt; &#123;</span><br><span class="line">            <span class="string">left   =&gt;</span> <span class="number">35</span>,</span><br><span class="line">            <span class="string">top    =&gt;</span> <span class="number">85</span>,</span><br><span class="line">            <span class="string">width  =&gt;</span> <span class="number">625</span>,</span><br><span class="line">            <span class="string">height =&gt;</span> <span class="number">400</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">#定义左右2列的幻灯片，左边为正文，右边为图片</span></span><br><span class="line">        <span class="string">'def_tbp'</span> =&gt; &#123;</span><br><span class="line">            <span class="string">'title'</span> =&gt; &#123;</span><br><span class="line">                <span class="string">left   =&gt;</span> <span class="number">35</span>,</span><br><span class="line">                <span class="string">top    =&gt;</span> <span class="number">40</span>,</span><br><span class="line">                <span class="string">width  =&gt;</span> <span class="number">625</span>,</span><br><span class="line">                <span class="string">height =&gt;</span> <span class="number">50</span>,</span><br><span class="line">                <span class="string">size   =&gt;</span> <span class="number">24</span>,</span><br><span class="line">                <span class="string">bold   =&gt;</span> <span class="number">1</span>,</span><br><span class="line">                <span class="string">name   =&gt;</span> <span class="string">'宋体'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">'body'</span> =&gt; &#123;</span><br><span class="line">                <span class="string">left   =&gt;</span> <span class="number">35</span>,</span><br><span class="line">                <span class="string">top    =&gt;</span> <span class="number">85</span>,</span><br><span class="line">                <span class="string">width  =&gt;</span> <span class="number">300</span>,</span><br><span class="line">                <span class="string">height =&gt;</span> <span class="number">400</span>,</span><br><span class="line">                <span class="string">size   =&gt;</span> <span class="number">24</span>,</span><br><span class="line">                <span class="string">bold   =&gt;</span> <span class="number">0</span>,</span><br><span class="line">                <span class="string">name   =&gt;</span> <span class="string">'宋体'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">'picture'</span> =&gt; &#123;</span><br><span class="line">                <span class="string">left   =&gt;</span> <span class="number">350</span>,</span><br><span class="line">                <span class="string">top    =&gt;</span> <span class="number">85</span>,</span><br><span class="line">                <span class="string">width  =&gt;</span><span class="number">300</span>,</span><br><span class="line">                <span class="string">height =&gt;</span> <span class="number">400</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">unlink</span> <span class="variable">$self</span>-&gt;&#123;file&#125;;</span><br><span class="line">    YAML::Tiny::DumpFile( <span class="string">"<span class="variable">$self</span>-&gt;&#123;file&#125;"</span>, \<span class="variable">%h</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"><span class="keyword">use</span> YAML::Syck;</span><br><span class="line"><span class="keyword">use</span> Data::Printer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$dir</span>      = Cwd::getcwd();</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$file_yml</span> = <span class="variable">$dir</span> . <span class="string">'/config.yaml'</span>;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$con</span>      = MyConfig-&gt;new( <span class="string">file =&gt;</span> <span class="variable">$file_yml</span> );</span><br><span class="line"><span class="variable">$con</span>-&gt;SetConf();</span><br><span class="line"></span><br><span class="line"><span class="comment">#读yaml</span></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$yaml</span> = LoadFile(<span class="variable">$file_yml</span>);</span><br><span class="line"><span class="comment">#p $yaml-&gt;&#123;body&#125;-&gt;&#123;left&#125;;</span></span><br><span class="line">p <span class="variable">$yaml</span>;</span><br></pre></td></tr></table></figure>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;利用MooseX::NonMoose::InsideOut继承非Moose模块Win32::PowerPoint。&lt;br&gt;
    
    </summary>
    
    
      <category term="Moose" scheme="https://github.com/tianyv/tianyv.github.io/tags/Moose/"/>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/tags/perl/"/>
    
  </entry>
  
  <entry>
    <title>中庸智慧引发的绩效管理思考</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2017/01/25/jxzyzd/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2017/01/25/jxzyzd/</id>
    <published>2017-01-24T18:35:57.000Z</published>
    <updated>2017-02-22T22:16:59.737Z</updated>
    
    <content type="html"><![CDATA[<p>忙忙碌碌，转眼又到年底，不知什么时候开始，每到年底总喜欢回顾过往，想起这一年的咨询经历，没成想，“叩其两端而执其中”的中庸之道给了我一些感触。<br><a id="more"></a></p>
<h2 id="一、管理，何为取其中">一、管理，何为取其中</h2><pre><code>在做管理咨询过程中，经常听到院长这么说：
</code></pre><p>现在院长越来越难当了，究其原因，多数院长说：一方面政府要求医院要体现公益性，另一方面又要求医院自主经营，自负盈亏。<br>从“二元对立”论来看，这是两个矛盾，鱼与熊掌不能兼得，但从中国传统“一分为三”的整体认识论来看，其实关键是要找准这个<strong>中</strong>，而这个中本人认为是<strong>医生要有工作积极性，要有提升技术的动力</strong>；作为医院要有机制让医生获得提升技术的机会与途径，使得医院技术力量不断提升，医疗安全得到保障；而最终病人得到有效地救治、病痛得到缓解或减轻。这或许可以使得鱼与熊掌在某种意义上来说得以兼得。</p>
<pre><code>院长认为医院的绩效工资水平已经不低了，但员工却仍然不满意，对提高报酬的期望很高。  
</code></pre><p>这要分两种情况来对待，一是如果医院确实有空间，并且与周边同行相比，员工收入水平持平或略高不多，可取的做法是降低员工期望的同时，还可考虑适当提高员工的绩效工资水平。<br>二是如果医院确实已经没有增加绩效的空间了（有可能是受政策限制，又或者可能是没法拿出更多的钱难来发绩效，因为账上已没多少钱了），此时提高绩效工资水平减少期望落差的做法就不可行了，这时管理的取其中本人认为是<strong>找准中层管理员工的个性化动机</strong>，而对于<strong>普通员工则是识别他们的公共工作动机</strong>（如新入职员工可能会将培训或获得锻炼的机会做为愿意承担责任的公共工作动机），看看是否有可能满足他们，因为德鲁克认为“证据显示，对奖金感到满意未必足以形成正面的工作动机。只有当员工出于其他动机而愿意承担责任时，金钱上的奖赏才能发挥激励作用。”</p>
<h2 id="二、如何取舍，如何平衡">二、如何取舍，如何平衡</h2><pre><code>经常有院长说，我给员工多发了钱了，但为什么大家反而意见更大  
</code></pre><p>究其原因，原来是钱发得不合理。没钱发时院长头痛，有钱了怎么发又是院长面临的另一道难题。<br>其实首先要明确能多发多少，这钱的作用是用来加大保健作用还是用来加大激励作用。<br>一是如果钱不多，而基本工资所占比重较小，那这钱可以以岗位绩效的形式发下去，主要体现员工的职称及职务，加大薪酬所起的保健作用。<br>二是如果钱多，而绩效工资所占比例不足或刚超过50%左右，并且员工积极性不高，那这钱可以加入绩效工资总量，按工作量拉开分配差距，加大薪酬所起的激励作用。<br>如果是其他情况，要不以年终奖或增设其他专项奖励的方式发下去，要不不如不发。</p>
<pre><code>绩效改革是维持稳定好，还是破旧立新好   
</code></pre><p>首先作为管理者需明确改革过程中不可能不产生矛盾，也不可能做到让所有的利益群体都满意。<br>其次绩效改革是利益的重新再分配，或在原来合理的基础上分配地更加公平或更有效，但均将打破现有平衡；同时绩效改革需拉开差距才能带来效率，但有了差距，就有了比较，员工又很容易产生不公平感，尤其是在信息不对称的情况下。<br>所以作为管理者要正视“希望改革获得尽可能多员工的<strong>认同</strong>”这一心理预期，更重要的是要有不怕得罪某个人或某个利益群体的思想准备，尽可能地坚持原则。关键是要识别出本次改革的撬动者是到底是谁，一切以这个群体为优先，当这个群体都还未得到满足前其他群体的利益诉求可暂放在后，有合适时机时再予以体现。</p>
<pre><code>绩效要拉开群体差距，但差距控制在多少才合适，如何控制
</code></pre><p>这个问题不展开说，只需明确两点：一、医生及业务中层是绩效改革是主要的撬动者；二、以临床第一，医技第二（护理群体与医技持平），行政后勤第三为原则<br>而作为科室二次分配，除了要控制好科主任与医生的差距外，还有个至关重要、需要避免出现的情况是：分配过程中不要让医生认为他们少拿是因为主任多拿了导致的，反之亦然。</p>
<pre><code>科主任与医生的绩效分配是否要有差别，差别在哪
</code></pre><p>医生的绩效工资要与过程指标相关，以过程激励为主；科主任的绩效要关注结果指标，体现结果导向<br>但医生以过程激励容易出现增劳不增效，出工不出力的不良现象，所以需科主任以结果导向来监督管理科室，以达到取中的平衡效果<br>如果科主任的绩效工资不与结果指标相关连，那科主任则会利用他手中的权力与资源从过程中获取更多的额外利益，给管理带来很多问题，如成本居高不下，把住手术刀，科室技术得不到提升等。</p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;忙忙碌碌，转眼又到年底，不知什么时候开始，每到年底总喜欢回顾过往，想起这一年的咨询经历，没成想，“叩其两端而执其中”的中庸之道给了我一些感触。&lt;br&gt;
    
    </summary>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="管理基础" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Carton 管理模块依赖</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2017/01/02/perlcarton/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2017/01/02/perlcarton/</id>
    <published>2017-01-01T17:02:02.000Z</published>
    <updated>2017-01-01T18:02:32.127Z</updated>
    
    <content type="html"><![CDATA[<p>曾在ChinaUnix论坛上写过关于Dancer的入门教程，后来由于Dancer版本的变更，有下载我所上传源码的网友反馈运行出错，后来虽然找到了原因并更新上传，但感觉挺麻烦的，后来在 Cpan 上找到了Carton,所以现在在用Dancer2写网站时增加了Carton作为管理模块依赖的工具。</p>
<a id="more"></a>
<h2 id="附本人在ChinaUnix论坛发的Dancer入门教程：">附本人在ChinaUnix论坛发的Dancer入门教程：</h2><ul>
<li><a href="http://bbs.chinaunix.net/thread-1753507-1-1.html" target="_blank" rel="external">本人用Dancer框架写的个人网站源码</a></li>
</ul>
<h2 id="一、安装Carton">一、安装Carton</h2><p>Modern perl使用的 Carton 学习了 Ruby 的 bundle 命令,同时也学来了类Gemfile的方式来书写与管理模块依赖，在Catton中我们使用cpanfile。</p>
<h3 id="1-1安装模块">1.1安装模块</h3><pre><code><span class="title">cpanm</span>  Carton
</code></pre><h2 id="二、Carton_用法">二、Carton 用法</h2><h3 id="2-1在项目文件夹下书写cpanfile">2.1在项目文件夹下书写cpanfile</h3><pre><code>requires "Moo" =&gt; "<span class="number">2.003000</span>"<span class="comment">;</span>
requires "Dancer2" =&gt; "<span class="number">0.204001</span>"<span class="comment">;</span>
requires "Dancer<span class="number">2::</span>Plugin<span class="number">::DB</span>IC"<span class="comment">;</span>
requires "Template"<span class="comment">;</span>
requires "YAML"<span class="comment">;</span>
recommends "YAML<span class="number">::</span>XS"<span class="comment">;</span>
recommends "URL<span class="number">::E</span>nco<span class="number">de::</span>XS"<span class="comment">;</span>
recommends "HTTP<span class="number">::</span>Parser<span class="number">::</span>XS"<span class="comment">;</span>

on "test" =&gt; sub {
    requires "Test<span class="number">::</span>More"            =&gt; "0"<span class="comment">;</span>
    requires "HTTP<span class="number">::</span>Request<span class="number">::C</span>ommon" =&gt; "0"<span class="comment">;</span>
}<span class="comment">;</span>
</code></pre><h3 id="2-2在cpanfile所在目录下，执行如下命令">2.2在cpanfile所在目录下，执行如下命令</h3><pre><code>carton <span class="keyword">install</span>
</code></pre><p>运行命令后会在目录下新生成一个名为 cpanfile.snapshot的文件。这个文件里会记录你本次安装的模块确切版本，这样你通过 github 等方式共享给其他人、发布到服务器等的时候，再用下面的命令就可以实现安装完全一致版本的模块了：</p>
<pre><code>carton <span class="operator"><span class="keyword">install</span> <span class="comment">--deployment</span></span>
</code></pre><h3 id="2-3_利用Carton启动Dancer2项目">2.3 利用Carton启动Dancer2项目</h3><p>Carton 默认安装到项目当前目录下的 local/ 子目录内。所以，先要进入项目目录再运行以下命令：</p>
<pre><code><span class="keyword">cd</span> <span class="keyword">E</span>:\MyApp
carton exec plackup bin/<span class="keyword">app</span>.psgi
</code></pre><h3 id="2-4打包">2.4打包</h3><p>Carton 有专门的一个 bundle 命令。把之前 install 在 local/ 里的模块，复制到 vendor/cache 目录下。然后通过下面命令来安装：</p>
<pre><code>carton <span class="operator"><span class="keyword">install</span> <span class="comment">--cached</span></span>
</code></pre><p>主要用于解决跨平台和系统部署问题,要点在于：carton 复制到 vendor/cache 目录下的，不是安装好的模块，而是各模块的 .tar.gz 包,这样运行以上命令会重新走一遍编译过程。</p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;曾在ChinaUnix论坛上写过关于Dancer的入门教程，后来由于Dancer版本的变更，有下载我所上传源码的网友反馈运行出错，后来虽然找到了原因并更新上传，但感觉挺麻烦的，后来在 Cpan 上找到了Carton,所以现在在用Dancer2写网站时增加了Carton作为管理模块依赖的工具。&lt;/p&gt;
    
    </summary>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/categories/perl/"/>
    
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/tags/perl/"/>
    
      <category term="简介" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%80%E4%BB%8B/"/>
    
  </entry>
  
  <entry>
    <title>绩效的简与繁、情与理</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/12/09/jxjfql/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/12/09/jxjfql/</id>
    <published>2015-12-09T12:19:32.000Z</published>
    <updated>2015-12-10T07:36:15.144Z</updated>
    
    <content type="html"><![CDATA[<p>大道至简，悟在天成。管理本非易事，更何况与个人利益息息相关的绩效管理与组织变革管理，更需要道与简的智慧，才能完成这一巨大的变革工程。<br><a id="more"></a></p>
<h3 id="一、绩效的简与繁">一、绩效的简与繁</h3><ul>
<li><p>繁</p>
<ul>
<li>绩效管理是个复杂的的系统工程</li>
<li>绩效管理涉及控制论、系统论、信息论、行为心理学、管理学、目标管理论、成本收益理论、权变理论、激励理论等理论</li>
<li>绩效管理方法、工具多样</li>
<li>考核指标的科学选取，持之与恒的贯彻落实</li>
<li>员工公平性认识的差异千差万别</li>
<li>人人不嫌钱多，最接受不了的是别人多自己太多</li>
<li>组织需改变的不合理现状或问题很多、很尖锐</li>
</ul>
</li>
<li><p>简</p>
<ul>
<li>对员工过去的付出，支付对等的绩效薪酬，能调动员工未来的工作热情，让员工的行为与组织目标相一致</li>
<li>绩效变革管理要求变革者尤其对目标管理论与行为心理学理论具有很深的造诣</li>
<li>没有最好，最科学的绩效管理体系，只有最适合组织当前环境管理需要的系统</li>
<li>考核、评价是一种社会现象，也是一种社会需要，但非绩效管理的核心和本质（积极性及质量均不是考核出来的）</li>
<li>需建立一个简单和统一的公平性评价标准,体现起点公平、机会均等，同时注重作好员工解释及沟通</li>
<li>分类设计群体绩效，合理控制差距（差异、差距与效率呈正相关关系）</li>
<li>将需改变或改善的问题揉合进绩效分配规则中，撬动整个组织和员工的转变</li>
</ul>
</li>
</ul>
<h3 id="二、绩效的情与理">二、绩效的情与理</h3><p>这里所说的情是指组织的情况与现状。而理则是指大局观、整体利益和规矩。<br>君子爱财，取之有道，以绩效工资来论，同样要取之有道，这个道有两重意思，一是取得合理水平即可，无过不及；二是通过自己的努力付出获得合法的报酬。  </p>
<p>少年时取其丰，舍其不能有；壮年时取其实，舍其不当有；老年时取其精，舍其不必有。<br>作为组织管理者和变革者更应谙熟取舍之道。</p>
<h3 id="三、做你现在能改变的事">三、做你现在能改变的事</h3><p>在这通过分享一个关于决择的小故事来说明这个问题：<br>一个农民从洪水中救起了他的妻子，他的孩子却被淹死了。<br>事后，人们议论纷纷。有的说他做得对，因为孩子可以再生一个，妻子却不能死而复活。有的说他做错了，因为妻子可另娶一个，孩子却不能死而复活。我听了人们的议论，也感到疑惑难决：如果只能救活一人，究竟应该救妻子呢，还是救孩子？于是我去拜访那个农民，问他当时是怎么想的？<br>他答道：“我什么也没想。洪水袭来，妻子在我身过，我抓住她就往附近的山坡游。  </p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;大道至简，悟在天成。管理本非易事，更何况与个人利益息息相关的绩效管理与组织变革管理，更需要道与简的智慧，才能完成这一巨大的变革工程。&lt;br&gt;
    
    </summary>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>薪酬水平调研抽样设计</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/12/03/fxsam/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/12/03/fxsam/</id>
    <published>2015-12-03T09:42:53.000Z</published>
    <updated>2015-12-09T12:18:33.467Z</updated>
    
    <content type="html"><![CDATA[<p>为了调查某个区域某行业某岗位的薪酬水平，科学地选取样本量，可以保证准确性的同时又能节约时间与成本。</p>
<ul>
<li>样本量太少，会导致误差过大</li>
<li>样本量太大，虽然保证了质量，但同时会增加过多的人力、物力及费用</li>
</ul>
<a id="more"></a>
<h2 id="一、样本精度要求">一、样本精度要求</h2><p>分两种情况设置样本精度要求：</p>
<ul>
<li>假如总体方差已知，在90%的置信度下，要求均值的误差不超过200</li>
<li>假如总体方差未知，在90%的置信度下，要求均值的误差不超过370</li>
</ul>
<h2 id="二、R代码模拟">二、R代码模拟</h2><p>采用某区域10家医院828名医生、916名护士某月的绩效工资水平作为总体。</p>
<figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">library<span class="params">(sampling)</span></span><br><span class="line">library<span class="params">(sampln)</span></span><br><span class="line"></span><br><span class="line">get.cw&lt;-getwd<span class="params">()</span></span><br><span class="line">fh&lt;-paste<span class="params">(get.cw,<span class="string">"sam.csv"</span>,sep = <span class="string">"/"</span>)</span></span><br><span class="line">print<span class="params">(fh)</span></span><br><span class="line">dff&lt;-read.csv<span class="params">(fh)</span></span><br><span class="line">colnames<span class="params">(dff)</span>&lt;-c<span class="params">(<span class="string">"NO"</span>,<span class="string">"name"</span>,<span class="string">"jd"</span>,<span class="string">"ks"</span>,<span class="string">"zw"</span>,<span class="string">"gw"</span>,<span class="string">"jx"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="params">(em in c<span class="params">(<span class="string">"医生"</span>,<span class="string">"护士"</span>)</span>)</span>&#123;</span><br><span class="line">  sub_df&lt;-subset<span class="params">(dff,dff$gw==em)</span></span><br><span class="line">  jx&lt;-sub_df$jx</span><br><span class="line">  n&lt;-length<span class="params">(jx)</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">#</span>打印描述统计结果</span><br><span class="line">  print<span class="params">(paste<span class="params">(em,<span class="string">"Summary:"</span>,sep=<span class="string">""</span>)</span>)</span></span><br><span class="line">  print<span class="params">(summary<span class="params">(jx)</span>)</span></span><br><span class="line">  sdjx&lt;-<span class="built_in">round</span><span class="params">(sd<span class="params">(jx)</span>,<span class="number">0</span>)</span></span><br><span class="line">  sT&lt;-<span class="built_in">round</span><span class="params">(var<span class="params">(jx)</span>)</span></span><br><span class="line">  print<span class="params">(paste<span class="params">(c<span class="params">(em,<span class="string">"sd:"</span>,sdjx)</span>,collapse=<span class="string">""</span>)</span>)</span></span><br><span class="line">  </span><br><span class="line">  print<span class="params">(paste<span class="params">(<span class="string">"N:"</span>,n,sep=<span class="string">""</span>)</span>)</span></span><br><span class="line"> </span><br><span class="line">  sam1&lt;-size.sample1<span class="params">(sdjx,conf.level=<span class="number">0.90</span>,<span class="number">200</span>)</span></span><br><span class="line">  print<span class="params">(paste<span class="params">(c<span class="params">(<span class="string">"总体方差已知：sam="</span>,sam1)</span>,collapse=<span class="string">""</span>)</span>)</span></span><br><span class="line">  s1&lt;-srswr<span class="params">(sam1,n)</span></span><br><span class="line">  sam1.jx&lt;-jx[s1==<span class="number">1</span>] </span><br><span class="line">  sam1.m&lt;-<span class="built_in">round</span><span class="params">(mean<span class="params">(sam1.jx)</span>,<span class="number">0</span>)</span></span><br><span class="line">  sam1.sd&lt;-<span class="built_in">round</span><span class="params">(sd<span class="params">(sam1.jx)</span>)</span></span><br><span class="line">  print<span class="params">(paste<span class="params">(c<span class="params">(<span class="string">"SAM1：样本均值："</span>,sam1.m,<span class="string">"样本标准差："</span>,sam1.sd)</span>,collapse=<span class="string">""</span>)</span>)</span></span><br><span class="line">  </span><br><span class="line">  sam2&lt;-size.sample2<span class="params">(sdjx,alpha=<span class="number">0.01</span>,<span class="number">370</span>,m=<span class="number">400</span>)</span> </span><br><span class="line">  print<span class="params">(paste<span class="params">(c<span class="params">(<span class="string">"总体方差未知：sam="</span>,sam2)</span>,collapse=<span class="string">""</span>)</span>)</span></span><br><span class="line">  s2&lt;-srswr<span class="params">(sam2,n)</span></span><br><span class="line">  sam2.jx&lt;-jx[s2==<span class="number">1</span>] </span><br><span class="line">  sam2.m&lt;-<span class="built_in">round</span><span class="params">(mean<span class="params">(sam2.jx)</span>,<span class="number">0</span>)</span></span><br><span class="line">  sam2.sd&lt;-<span class="built_in">round</span><span class="params">(sd<span class="params">(sam2.jx)</span>)</span></span><br><span class="line">  print<span class="params">(paste<span class="params">(c<span class="params">(<span class="string">"SAM2：样本均值："</span>,sam2.m,<span class="string">"样本标准差："</span>,sam2.sd)</span>,collapse=<span class="string">""</span>)</span>)</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三、R输出结果">三、R输出结果</h2><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="string">"医生Summary:"</span></span><br><span class="line">   <span class="name">Min</span>. <span class="number">1</span><span class="atom">st</span> <span class="name">Qu</span>.  <span class="name">Median</span>    <span class="name">Mean</span> <span class="number">3</span><span class="atom">rd</span> <span class="name">Qu</span>.    <span class="name">Max</span>. </span><br><span class="line">    <span class="number">238</span>    <span class="number">3374</span>    <span class="number">4956</span>    <span class="number">4762</span>    <span class="number">6104</span>   <span class="number">10020</span> </span><br><span class="line">[<span class="number">1</span>] <span class="string">"医生sd:1941"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"N:828"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"总体方差已知：sam=255"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"SAM1：样本均值：4824样本标准差：2007"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"总体方差未知：sam=347"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"SAM2：样本均值：4780样本标准差：1813"</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>] <span class="string">"护士Summary:"</span></span><br><span class="line">   <span class="name">Min</span>. <span class="number">1</span><span class="atom">st</span> <span class="name">Qu</span>.  <span class="name">Median</span>    <span class="name">Mean</span> <span class="number">3</span><span class="atom">rd</span> <span class="name">Qu</span>.    <span class="name">Max</span>. </span><br><span class="line">    <span class="number">102</span>    <span class="number">2008</span>    <span class="number">3232</span>    <span class="number">3346</span>    <span class="number">4729</span>    <span class="number">8741</span> </span><br><span class="line">[<span class="number">1</span>] <span class="string">"护士sd:1787"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"N:916"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"总体方差已知：sam=216"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"SAM1：样本均值：3381样本标准差：1896"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"总体方差未知：sam=294"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"SAM2：样本均值：3361样本标准差：1803"</span></span><br></pre></td></tr></table></figure>
<h2 id="四、以医生结果做为说明">四、以医生结果做为说明</h2><p>从医生总体的概述可知道，医生的月均绩效工资为4762元，总体标准差为1941，共有828名医生。</p>
<ul>
<li>总体方差已知(标准差为1941)：我们只需选取255个样本，就可保证90%的可信度，样本的均值与总体的均值误差控制在正负200以内（相对与4762来说，相差200精度要求已很高了）<ul>
<li>而模拟结果样本均值为4824，与总体误差只有60元左右</li>
</ul>
</li>
<li>总体方差未知：我们需选取347个样本，就可保证90%的可信度，样本的均值与总体的均值误差控制在正负370以内<ul>
<li>而模拟结果样本均值为4780，与总体误差只有20元左右</li>
</ul>
</li>
</ul>
<p>注：样本量的大小并不受总体N的影响，只与我们的精度要求及样本方差的大小有关，换句话说即便某区域的总体为10000而非828个医生时，样本只要选取255个或347同样能准确的计算出医生的绩效工资水平或收入水平。</p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;为了调查某个区域某行业某岗位的薪酬水平，科学地选取样本量，可以保证准确性的同时又能节约时间与成本。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;样本量太少，会导致误差过大&lt;/li&gt;
&lt;li&gt;样本量太大，虽然保证了质量，但同时会增加过多的人力、物力及费用&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Mojolicious Login Example</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/11/22/mojoLogin/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/11/22/mojoLogin/</id>
    <published>2015-11-21T20:21:57.000Z</published>
    <updated>2015-11-21T20:35:38.521Z</updated>
    
    <content type="html"><![CDATA[<p>Mojolicious+Boostrap3 Login Example!</p>
<ul>
<li>Boostrap3 </li>
<li>Mojolicious::Lite </li>
<li>session、Login、Plugin MyAuth  <a id="more"></a>
</li>
</ul>
<p>详细源码请到chinaunix论坛下载。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> Mojolicious::Lite;</span><br><span class="line"></span><br><span class="line">helper <span class="string">auth =&gt;</span> <span class="sub"><span class="keyword">sub</span> &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$c</span>, <span class="variable">$username</span>, <span class="variable">$password</span> ) = <span class="variable">@_</span>;</span><br><span class="line">    <span class="keyword">state</span> <span class="variable">$users</span> = &#123; <span class="string">tianyv =&gt;</span> <span class="string">'123'</span>, &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">unless</span> <span class="variable">$users</span>-&gt;&#123;<span class="variable">$username</span>&#125; eq <span class="variable">$password</span>;</span><br><span class="line">    <span class="variable">$c</span>-&gt;session( <span class="string">user =&gt;</span> <span class="variable">$username</span> );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">any <span class="string">'/'</span> =&gt; <span class="sub"><span class="keyword">sub</span> &#123;</span></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$c</span> = <span class="keyword">shift</span>;</span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$username</span>, <span class="variable">$password</span> ) = <span class="keyword">map</span> &#123; <span class="variable">$c</span>-&gt;param(<span class="variable">$_</span>) &#125; <span class="keyword">qw</span>/username password/;</span><br><span class="line">    <span class="variable">$c</span>-&gt;auth( <span class="variable">$username</span>, <span class="variable">$password</span> ) <span class="keyword">if</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="variable">$c</span>-&gt;render(<span class="string">'index'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">any <span class="string">'/logout'</span> =&gt; <span class="sub"><span class="keyword">sub</span> &#123;</span></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$c</span> = <span class="keyword">shift</span>;</span><br><span class="line">    <span class="variable">$c</span>-&gt;session( <span class="string">expires =&gt;</span> <span class="number">1</span> );</span><br><span class="line">    <span class="variable">$c</span>-&gt;redirect_to(<span class="string">'/'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app-&gt;start;</span><br></pre></td></tr></table></figure>
<p>视图效果：</p>
<p><img src="/img/perl/01mojoLogin.gif" width="600"><br><img src="/img/perl/02mojoLogin.gif" width="600"><br><img src="/img/perl/03mojoLogin.gif" width="600"><br><img src="/img/perl/04mojoLogin.gif" width="600"></p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Mojolicious+Boostrap3 Login Example!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Boostrap3 &lt;/li&gt;
&lt;li&gt;Mojolicious::Lite &lt;/li&gt;
&lt;li&gt;session、Login、Plugin MyAuth
    
    </summary>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/categories/perl/"/>
    
    
      <category term="Boostrap3" scheme="https://github.com/tianyv/tianyv.github.io/tags/Boostrap3/"/>
    
      <category term="Input" scheme="https://github.com/tianyv/tianyv.github.io/tags/Input/"/>
    
      <category term="Mojolicious" scheme="https://github.com/tianyv/tianyv.github.io/tags/Mojolicious/"/>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/tags/perl/"/>
    
  </entry>
  
  <entry>
    <title>医院预算管理基础</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/08/13/ysth/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/08/13/ysth/</id>
    <published>2015-08-13T15:48:25.000Z</published>
    <updated>2015-09-17T01:13:58.385Z</updated>
    
    <content type="html"><![CDATA[<p>医院新财务与会计制度改革目的：一是加强医院财务管理和监督，规范医院财务行为，提高资金使用效率；二是为政府部门制定医疗改革政策、医疗收费价格以及实施医院绩效评价等提供依据；三是将成本控制目标、预算执行情况作为财政补助安排的重要依据。因此上级政府部门要求医院强化预算管理，强化成本核算与管控。</p>
<a id="more"></a>
<h2 id="一、预算编制原则：">一、预算编制原则：</h2><ul>
<li>以收定支、收支平衡、统筹兼顾、保证重点</li>
<li>不得编制赤字预算</li>
<li>收入支出核算符合新会计制度<ul>
<li>会计科目设置符合新会计制度</li>
<li>成本核算的原则、对象及成本归集和转移的方法符合制度</li>
<li>不应计入成本范围的开支不能超出新会计制度规定的范围</li>
</ul>
</li>
</ul>
<h2 id="二、财务报表会计科目：">二、财务报表会计科目：</h2><p><img src="/img/ys/01kjkm.png" width="700"></p>
<h2 id="三、预算编制模版：">三、预算编制模版：</h2><p><img src="/img/ys/02ysbb.png" width="700"></p>
<h2 id="四、关键点">四、关键点</h2><ul>
<li>收入的预算要以医院战略为基础，需要相应的激励手段、资源投入或政策倾斜来保障</li>
<li>对医院的运营情况要有清晰的认识，有科室成本谱、项目成本谱和病种成本谱</li>
<li>根据科室不同特点制定科室预算<ul>
<li>快速发展科室仍有多少发展空间，同时任务目标定成多少科主任认为是合理的，科室有意愿执行预算</li>
<li>成熟科室重在挖掘新的业务增长点，或加大成本控制力度提高结余率</li>
<li>大型设备投入要有可行性论证，设备买回后可进行单机核算</li>
</ul>
</li>
<li>定项补助的具体项目和标准，由同级财政部门会同主管部门，根据政府卫生投入政策的有关规定确定</li>
<li>执行预算期间，有重大政策调整，要对预算及时进行调整</li>
</ul>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;医院新财务与会计制度改革目的：一是加强医院财务管理和监督，规范医院财务行为，提高资金使用效率；二是为政府部门制定医疗改革政策、医疗收费价格以及实施医院绩效评价等提供依据；三是将成本控制目标、预算执行情况作为财政补助安排的重要依据。因此上级政府部门要求医院强化预算管理，强化成本核算与管控。&lt;/p&gt;
    
    </summary>
    
      <category term="预算管理" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E9%A2%84%E7%AE%97%E7%AE%A1%E7%90%86/"/>
    
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="预算管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E9%A2%84%E7%AE%97%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Shiny</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/08/06/rShiny/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/08/06/rShiny/</id>
    <published>2015-08-06T06:43:08.000Z</published>
    <updated>2015-12-11T02:40:55.250Z</updated>
    
    <content type="html"><![CDATA[<p>Shiny是r简易制作交互网页的包，功能强大，很适合咨询师用作数据分析及可视化的工具。可见本站导航“工具”内1.2医院定岗定编工具：<a href="[tianyv.github.io/tools/">http://tianyv.github.io/tools/</a></p>
<a id="more"></a>
<h2 id="一、客户端、服务器示例">一、客户端、服务器示例</h2><h4 id="1-1Server">1.1Server</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(shiny)</span><br><span class="line">Server&lt;-<span class="keyword">function</span>(input, output) &#123;</span><br><span class="line">  output$text1 &lt;- renderText(&#123;       </span><br><span class="line">    paste(<span class="string">"你选择的是："</span>, input$var)    </span><br><span class="line">  &#125;)        </span><br><span class="line">  output$text2 &lt;- renderText(&#123;</span><br><span class="line">    paste(<span class="string">"你选择的数据范围是："</span>,</span><br><span class="line">          input$range[<span class="number">1</span>], <span class="string">"to"</span>, input$range[<span class="number">2</span>])</span><br><span class="line">  &#125;)</span><br><span class="line">  output$text3 &lt;- renderText(&#123;</span><br><span class="line">    paste(<span class="string">"今天的日期是："</span>,</span><br><span class="line">          input$date)</span><br><span class="line">  &#125;)</span><br><span class="line">  output$distPlot &lt;- renderPlot(&#123;</span><br><span class="line">    x    &lt;- faithful[, <span class="number">2</span>] </span><br><span class="line">    <span class="comment"># Old Faithful Geyser data    </span></span><br><span class="line">    bins &lt;- seq(min(x), max(x), length.out = input$bins + <span class="number">1</span>) </span><br><span class="line">    print(input$bins)</span><br><span class="line">    <span class="comment"># draw the histogram with the specified number of bins    </span></span><br><span class="line">    hist(x, breaks = bins, col = <span class="string">'skyblue'</span>, border = <span class="string">'white'</span>)  </span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-2Ui">1.2Ui</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">UI&lt;-fluidPage(</span><br><span class="line">    titlePanel(<span class="string">"inputs and tabsetpanel example"</span>),  </span><br><span class="line">    sidebarLayout(    </span><br><span class="line">      sidebarPanel(</span><br><span class="line">        width = <span class="number">3</span>,</span><br><span class="line">        selectInput(<span class="string">"var"</span>,</span><br><span class="line">          label = <span class="string">"请选择"</span>,</span><br><span class="line">          choices = c(<span class="string">"Percent White"</span>, <span class="string">"Percent Black"</span>,</span><br><span class="line">            <span class="string">"Percent Hispanic"</span>, <span class="string">"Percent Asian"</span>),</span><br><span class="line">          selected = <span class="string">"Percent White"</span>),</span><br><span class="line">        </span><br><span class="line">        sliderInput(<span class="string">"bins"</span>,                  </span><br><span class="line">                    <span class="string">"轴状图分隔单位:"</span>,                  </span><br><span class="line">                    min = <span class="number">5</span>,                  </span><br><span class="line">                    max = <span class="number">50</span>,                  </span><br><span class="line">                    value = <span class="number">30</span>),    </span><br><span class="line">      </span><br><span class="line">        sliderInput(<span class="string">"range"</span>,</span><br><span class="line">          label = <span class="string">"请选择"</span>,</span><br><span class="line">          min = <span class="number">0</span>, max = <span class="number">100</span>, value = c(<span class="number">30</span>, <span class="number">60</span>)),</span><br><span class="line">        </span><br><span class="line">        dateInput(<span class="string">"date"</span>,</span><br><span class="line">          label = <span class="string">"日历"</span>,</span><br><span class="line">          language = <span class="string">"zh-CN"</span></span><br><span class="line">          )</span><br><span class="line">      ),    </span><br><span class="line"></span><br><span class="line">      mainPanel(</span><br><span class="line">        tabsetPanel( </span><br><span class="line">          <span class="comment">#show panel</span></span><br><span class="line">          tabPanel(</span><br><span class="line">            title = <span class="string">"Show"</span>,      </span><br><span class="line">            textOutput(<span class="string">"text1"</span>), </span><br><span class="line">            textOutput(<span class="string">"text2"</span>),</span><br><span class="line">            textOutput(<span class="string">"text3"</span>),</span><br><span class="line">            plotOutput(<span class="string">"distPlot"</span>) </span><br><span class="line">          ), </span><br><span class="line">          <span class="comment"># About panel</span></span><br><span class="line">          tabPanel(</span><br><span class="line">             title = <span class="string">"About"</span>,</span><br><span class="line">             p(strong(<span class="string">"作者:"</span>), <span class="string">"赖韬"</span>),</span><br><span class="line">             p(strong(<span class="string">"职业:"</span>), <span class="string">"咨询师、数据分析师"</span>),</span><br><span class="line">             p(strong(<span class="string">"Email:"</span>), <span class="string">"laitaot@126.com"</span>),</span><br><span class="line">             p(strong(<span class="string">"Blog:"</span>), a(<span class="string">"http://tianyv.github.io"</span>, </span><br><span class="line">                                     href = <span class="string">"http://tianyv.github.io"</span>,</span><br><span class="line">                                     target = <span class="string">"_blank"</span>)),</span><br><span class="line">             p(strong(<span class="string">"Created with:"</span>), </span><br><span class="line">               a(<span class="string">"RStudio"</span>,</span><br><span class="line">                 href = <span class="string">"http://www.rstudio.com/"</span>,</span><br><span class="line">                 target = <span class="string">"_blank"</span>), </span><br><span class="line">               <span class="string">" and "</span>,</span><br><span class="line">               a(<span class="string">"Shiny."</span>,</span><br><span class="line">                 href = <span class="string">"http://shiny.rstudio.com"</span>,</span><br><span class="line">                 target = <span class="string">"_blank"</span>))</span><br><span class="line">           )</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">     )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="二、效果图">二、效果图</h2><p><img src="/img/r/01shiny.png" width="700"></p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Shiny是r简易制作交互网页的包，功能强大，很适合咨询师用作数据分析及可视化的工具。可见本站导航“工具”内1.2医院定岗定编工具：&lt;a href=&quot;[tianyv.github.io/tools/&quot;&gt;http://tianyv.github.io/tools/&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="R" scheme="https://github.com/tianyv/tianyv.github.io/categories/R/"/>
    
    
      <category term="R" scheme="https://github.com/tianyv/tianyv.github.io/tags/R/"/>
    
      <category term="Shiny" scheme="https://github.com/tianyv/tianyv.github.io/tags/Shiny/"/>
    
      <category term="分析工具" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>收费价格调整对医院的影响</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/08/05/fxzctz/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/08/05/fxzctz/</id>
    <published>2015-08-05T02:21:55.000Z</published>
    <updated>2015-08-30T01:05:15.751Z</updated>
    
    <content type="html"><![CDATA[<p>今年，随着医疗改革的深入，多个省份药品实施零差价销售、损失的利润通过收费价格调整来弥补。由于政策的变化，多家客户希望通过我们的帮助，了解价格调整对医院的影响，对绩效方案进行合理调整，并说服员工接受方案的调整。而本章仅重点说明收费价格调整对医院的影响。<br><a id="more"></a></p>
<h2 id="一、收费价格调整对医院的影响">一、收费价格调整对医院的影响</h2><ul>
<li>本次收费价格调整（以广东省为例）：<ul>
<li>西药零差价，少了15%利润</li>
<li>CT降价12%</li>
<li>检验费降价5%</li>
<li>其他项目调价平均增加12%</li>
</ul>
</li>
</ul>
<p><img src="/img/sjfx/03-1tjyx.png" width="500"></p>
<p>以一家未调价前药占比40%、CT占比4.5%和检验占比15%的医院为例，假如年收入1个亿，降价全年损失纯收入730万，上调项目只弥补486万，医院倒亏240万。相当于每收病人100元，受此次价格调整的影响，医院损失2.4元；而药品比例相对合理达30%医院，每收病人100元，受此次价格调整的影响，医院只损失1毛钱。</p>
<h2 id="二、收费价格调整对各收费项目的影响">二、收费价格调整对各收费项目的影响</h2><ul>
<li>从收费项目来看：<ul>
<li>重点增加原收费标准严重偏低的劳务性收入:增幅最大的是护理费及诊查费</li>
<li>增加难度大风险高的收费项目:手术费及麻醉费增长20%</li>
<li>增加心电（20%）、胃镜（20%）和脑电（7.8%）小特功能科室的收费项目</li>
<li>降低大型设备CT检查费用12%；降低化验检查费用5%</li>
</ul>
</li>
</ul>
<p><img src="/img/sjfx/03-2tzbh.png" width="550"></p>
<h2 id="三、收费价格调整对科室核算收入的影响">三、收费价格调整对科室核算收入的影响</h2><ul>
<li>科室核算收入分析结果（不附表）：<ul>
<li>没明显变化的科室：ICU、急诊科、门诊和B超室</li>
<li>内科系统平均增长10%、外科系统平均增长13%、眼耳鼻喉科15%、儿科13%</li>
<li>增长接近20%的科室：血透室、手术室、中医科、口腔科、胃镜室、心电图室</li>
</ul>
</li>
</ul>
<h2 id="四、药占比控制要求">四、药占比控制要求</h2><p>随本次收费价格调整一起，广东省还以文件的方式下发了药占比的控制标准，调价后的医院药占比要控制在30%以内。</p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今年，随着医疗改革的深入，多个省份药品实施零差价销售、损失的利润通过收费价格调整来弥补。由于政策的变化，多家客户希望通过我们的帮助，了解价格调整对医院的影响，对绩效方案进行合理调整，并说服员工接受方案的调整。而本章仅重点说明收费价格调整对医院的影响。&lt;br&gt;
    
    </summary>
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>R面向对象系统R6包及其继承</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/07/25/R6oop/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/07/25/R6oop/</id>
    <published>2015-07-25T13:21:30.000Z</published>
    <updated>2015-07-25T13:34:16.393Z</updated>
    
    <content type="html"><![CDATA[<p>这一章介绍R面向对象系统R6及其继承。<br><a id="more"></a></p>
<h4 id="一、R6_Example">一、R6 Example</h4><p><strong>R6的类成员</strong>，包括<strong>属性</strong>和<strong>方法</strong>2部分</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(R6)</span><br><span class="line"><span class="comment">#定义一个R6类</span></span><br><span class="line">TimePay &lt;- R6Class(<span class="string">"TimePay"</span>,</span><br><span class="line">  public=list(</span><br><span class="line">    <span class="comment">#公有属性</span></span><br><span class="line">    name=<span class="literal">NA</span>, </span><br><span class="line">    initialize = <span class="keyword">function</span>(name,pay)&#123; </span><br><span class="line">    self$name &lt;- name</span><br><span class="line">    private$pay &lt;- pay</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">#定义公有方法</span></span><br><span class="line">    Income = <span class="keyword">function</span>()&#123; </span><br><span class="line">      print(paste(<span class="string">"你好"</span>,self$name))</span><br><span class="line">      print(paste(<span class="string">"你本月工资:"</span>,private$pay))</span><br><span class="line">    &#125;</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">#私有属性  </span></span><br><span class="line">  private=list(pay=<span class="literal">NA</span>)</span><br><span class="line">)</span><br><span class="line">tp&lt;-TimePay$new(<span class="string">"Tianyv"</span>,<span class="number">4400</span>)</span><br><span class="line">tp$Income()</span><br></pre></td></tr></table></figure>
<p>定义公有属性及方法用<strong>public=list(属性,方法=function(){})</strong>,私有用<strong>private</strong>;<br>访问公有用：self$属性，self$方法();访问私有用：private$属性，private$方法()</p>
<h4 id="二、R6类的继承关系">二、R6类的继承关系</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">OverTimePay &lt;- R6Class(<span class="string">"OverTimePay"</span>,</span><br><span class="line">  inherit = TimePay,</span><br><span class="line">  public=list(</span><br><span class="line">    day=<span class="literal">NA</span>, </span><br><span class="line">    getday = <span class="keyword">function</span>() self$day,</span><br><span class="line">    setday = <span class="keyword">function</span>(value) self$day &lt;- value,</span><br><span class="line">    Income = <span class="keyword">function</span>()&#123; </span><br><span class="line">    super$Income()</span><br><span class="line">    print(paste(<span class="string">"你本月加班天:"</span>,self$day))</span><br><span class="line">    overtime.pay=private$pay/<span class="number">22</span>*<span class="number">3</span>*self$day</span><br><span class="line">    print(paste(<span class="string">"加班工资:"</span>,overtime.pay))</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">otp&lt;-OverTimePay$new(<span class="string">"Tianyv"</span>,<span class="number">4400</span>)</span><br><span class="line">otp$setday(<span class="number">3</span>)</span><br><span class="line">otp$Income()</span><br></pre></td></tr></table></figure>
<p>继承使用<strong>inherit</strong>；调用父类方法用<strong>super$Fun()</strong></p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这一章介绍R面向对象系统R6及其继承。&lt;br&gt;
    
    </summary>
    
      <category term="R" scheme="https://github.com/tianyv/tianyv.github.io/categories/R/"/>
    
    
      <category term="R" scheme="https://github.com/tianyv/tianyv.github.io/tags/R/"/>
    
      <category term="R6" scheme="https://github.com/tianyv/tianyv.github.io/tags/R6/"/>
    
      <category term="oop" scheme="https://github.com/tianyv/tianyv.github.io/tags/oop/"/>
    
  </entry>
  
  <entry>
    <title>Moose的继承</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/07/25/mooseext/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/07/25/mooseext/</id>
    <published>2015-07-25T13:16:04.000Z</published>
    <updated>2015-07-25T13:25:24.728Z</updated>
    
    <content type="html"><![CDATA[<p>这一章介绍perl面向对象Moose的继承。<br><a id="more"></a></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> TimePay;</span><br><span class="line"><span class="keyword">use</span> Moose;</span><br><span class="line"><span class="keyword">use</span> Modern::Perl;</span><br><span class="line"></span><br><span class="line">has <span class="string">name =&gt;</span> ( <span class="string">is =&gt;</span> <span class="string">'rw'</span>, <span class="string">isa =&gt;</span> <span class="string">'Str'</span> );</span><br><span class="line">has <span class="string">pay  =&gt;</span> ( <span class="string">is =&gt;</span> <span class="string">'rw'</span>, <span class="string">isa =&gt;</span> <span class="string">'Int'</span> );</span><br><span class="line"></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> Income &#123;</span></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$self</span> = <span class="keyword">shift</span>;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">'你好'</span> . <span class="variable">$self</span>-&gt;name;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">'你本月工资:'</span> . <span class="variable">$self</span>-&gt;pay;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> OverTimePay;</span><br><span class="line"><span class="keyword">use</span> Moose;</span><br><span class="line"><span class="keyword">use</span> Modern::Perl;</span><br><span class="line"></span><br><span class="line">extends <span class="string">"TimePay"</span>;</span><br><span class="line"></span><br><span class="line">has <span class="string">day =&gt;</span> ( <span class="string">is =&gt;</span> <span class="string">'rw'</span>, <span class="string">isa =&gt;</span> <span class="string">'Int'</span> );</span><br><span class="line"></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> Income &#123;</span></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$self</span> = <span class="keyword">shift</span>;</span><br><span class="line">    <span class="variable">$self</span>-&gt;SUPER::Income();</span><br><span class="line">    <span class="keyword">say</span> <span class="string">'你本月加班天:'</span> . <span class="variable">$self</span>-&gt;day;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$overtime_pay</span> = <span class="variable">$self</span>-&gt;pay / <span class="number">22</span> * <span class="number">3</span> * <span class="variable">$self</span>-&gt;day;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">'加班工资:'</span> . <span class="variable">$self</span>-&gt;pay;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main;</span><br><span class="line"></span><br><span class="line"><span class="comment">#my $tp =TimePay-&gt; new ( name=&gt;"Tianyv",pay=&gt; 4400 );</span></span><br><span class="line"><span class="comment">#$tp-&gt;Income();</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$otp</span> = OverTimePay-&gt;new( <span class="string">name =&gt;</span> <span class="string">"Tianyv"</span>, <span class="string">pay =&gt;</span> <span class="number">4400</span> );</span><br><span class="line"><span class="variable">$otp</span>-&gt;day(<span class="number">3</span>);</span><br><span class="line"><span class="variable">$otp</span>-&gt;Income();</span><br></pre></td></tr></table></figure>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这一章介绍perl面向对象Moose的继承。&lt;br&gt;
    
    </summary>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/categories/perl/"/>
    
    
      <category term="Moose" scheme="https://github.com/tianyv/tianyv.github.io/tags/Moose/"/>
    
      <category term="oop" scheme="https://github.com/tianyv/tianyv.github.io/tags/oop/"/>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/tags/perl/"/>
    
  </entry>
  
  <entry>
    <title>Web::Scraper抓取网页信息</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/07/17/perlScraper/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/07/17/perlScraper/</id>
    <published>2015-07-17T11:03:56.000Z</published>
    <updated>2015-08-30T01:07:21.475Z</updated>
    
    <content type="html"><![CDATA[<p>公司分配了个工作，将某网站上所有专家的文章复制下来，如果手工操作，花时间不说，而且枯燥折磨人，于是用Web::Scraper写个爬虫，从网页中抓取内容并将内容写进word文档。<br><a id="more"></a></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> URI;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"><span class="keyword">use</span> Encode;</span><br><span class="line"><span class="keyword">use</span> File::Path;</span><br><span class="line"><span class="keyword">use</span> File::Slurp;</span><br><span class="line"><span class="keyword">use</span> Web::Scraper;</span><br><span class="line"><span class="keyword">use</span> Win32::OLE;</span><br><span class="line"><span class="keyword">use</span> Win32::OLE::Variant;</span><br><span class="line"><span class="keyword">use</span> Win32::OLE::Const <span class="string">'Microsoft.Word'</span>;      <span class="comment"># wd  constants</span></span><br><span class="line"><span class="keyword">use</span> Win32::OLE::Const <span class="string">'Microsoft Office'</span>;    <span class="comment"># mso constants</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$url</span> =</span><br><span class="line">  <span class="string">"http://www.chinahealthreform.org/index.php/professor/niuzhengqian.html?start=9"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$proce</span> = scraper &#123;</span><br><span class="line">    process <span class="string">'.componentheading'</span>, <span class="string">'author'</span>   =&gt; <span class="string">'TEXT'</span>;</span><br><span class="line">    process <span class="string">'.contentheading'</span>,   <span class="string">'tables[]'</span> =&gt; scraper &#123;</span><br><span class="line">        process <span class="string">'a'</span>, <span class="string">'link'</span> =&gt; <span class="string">'@href'</span>, <span class="string">'text'</span> =&gt; <span class="string">'TEXT'</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$res</span>       = <span class="variable">$proce</span>-&gt;scrape( URI-&gt;new(<span class="variable">$url</span>) );</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$author</span>    = <span class="variable">$res</span>-&gt;&#123;author&#125;;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$re_author</span> = T(<span class="variable">$author</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$path</span>=add_forder( <span class="variable">$url</span>, <span class="variable">$re_author</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">my</span> <span class="variable">$table</span> ( @&#123; <span class="variable">$res</span>-&gt;&#123;tables&#125; &#125; ) &#123;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$link</span>    = <span class="variable">$table</span>-&gt;&#123;link&#125;;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$text</span>    = <span class="variable">$table</span>-&gt;&#123;text&#125;;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$re_link</span> = T(<span class="variable">$link</span>);</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$f_name</span> = T(<span class="variable">$text</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$fetch</span> = fetch(<span class="variable">$re_link</span>,<span class="variable">$path</span>,<span class="variable">$f_name</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> add_forder &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$url</span>, <span class="variable">$author</span> ) = <span class="variable">@_</span>;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$num</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="variable">$url</span> =~ <span class="regexp">/.*\?start=(\d&#123;1,&#125;)/</span> ) &#123;</span><br><span class="line">        <span class="variable">$num</span> = <span class="variable">$1</span> / <span class="number">9</span> + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$num</span> = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$dir</span> = getcwd;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$path</span>=<span class="variable">$dir</span>.<span class="string">'/'</span>.<span class="variable">$author</span>.<span class="string">'/'</span>. <span class="variable">$num</span> ;</span><br><span class="line">    mkpath( <span class="variable">$path</span>, <span class="number">1</span>, <span class="number">0777</span> ) <span class="keyword">unless</span> ( -e <span class="variable">$path</span> );</span><br><span class="line">    <span class="keyword">print</span> <span class="variable">$path</span>,<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$path</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> T &#123;</span></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$text</span> = <span class="keyword">shift</span>;</span><br><span class="line">    <span class="keyword">return</span> encode( <span class="string">'gb2312'</span>, <span class="variable">$text</span> );</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> fetch &#123;</span></span><br><span class="line">    <span class="keyword">my</span> (<span class="variable">$url</span>,<span class="variable">$path</span>,<span class="variable">$f_name</span>)=<span class="variable">@_</span>;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$proce</span> = scraper &#123;</span><br><span class="line">        <span class="comment">#process '.nopad/table[1]/tr/td/a', "title"   =&gt; "TEXT";</span></span><br><span class="line">        process <span class="string">'.nopad/table[2]/tr/td/p'</span>, <span class="string">"texts[]"</span> =&gt; <span class="string">"TEXT"</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$res</span>   = <span class="variable">$proce</span>-&gt;scrape( URI-&gt;new(<span class="variable">$url</span>) );</span><br><span class="line">    <span class="comment">#my $title = T( $res-&gt;&#123;title&#125; );</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$word</span> = Win32::OLE-&gt;new(<span class="string">"Word.Application"</span>);</span><br><span class="line">       <span class="variable">$word</span>-&gt;&#123;Visible&#125; = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$document</span> = <span class="variable">$word</span>-&gt;Documents-&gt;Add;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$selection</span>=<span class="variable">$document</span>-&gt;ActiveWindow-&gt;Selection;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$Font</span> = <span class="variable">$selection</span> -&gt;Range-&gt;&#123;Font&#125;;</span><br><span class="line">    <span class="variable">$Font</span>-&gt;&#123;name&#125; = <span class="string">"宋体"</span>;</span><br><span class="line">    <span class="variable">$Font</span>-&gt;&#123;Size&#125; = <span class="number">14</span>;</span><br><span class="line">    <span class="variable">$selection</span>-&gt;ParagraphFormat-&gt;&#123;Alignment&#125;=<span class="string">'wdAlignParagraphCenter'</span>;</span><br><span class="line">    <span class="variable">$selection</span>-&gt;TypeText(<span class="variable">$f_name</span>);</span><br><span class="line">    <span class="variable">$selection</span>-&gt;TypeParagraph;</span><br><span class="line">    <span class="variable">$selection</span>-&gt;TypeParagraph;</span><br><span class="line">    <span class="variable">$selection</span>-&gt;ParagraphFormat-&gt;&#123;Alignment&#125;=<span class="string">'wdAlignParagraphCenter'</span>;</span><br><span class="line">    <span class="variable">$selection</span>-&gt;ParagraphFormat-&gt;&#123;AutoAdjustRightIndent&#125; = <span class="number">1</span>;</span><br><span class="line">    <span class="variable">$selection</span>-&gt;ParagraphFormat-&gt;&#123;CharacterUnitFirstLineIndent&#125; = <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">my</span> <span class="variable">$re</span> ( @&#123; <span class="variable">$res</span>-&gt;&#123;texts&#125; &#125; ) &#123;</span><br><span class="line">        <span class="keyword">my</span> <span class="variable">$par</span> = T(<span class="variable">$re</span>);</span><br><span class="line">            <span class="variable">$selection</span>-&gt; TypeText(<span class="variable">$par</span>);</span><br><span class="line">            <span class="variable">$selection</span>-&gt; TypeParagraph;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">my</span> <span class="variable">$file</span>=<span class="variable">$path</span> .<span class="string">'/'</span>. <span class="variable">$f_name</span> .<span class="string">'.doc'</span>;</span><br><span class="line">    <span class="variable">$document</span>-&gt;SaveAs(&#123;</span><br><span class="line">             <span class="string">FileName   =&gt;</span> <span class="variable">$file</span>,</span><br><span class="line">             <span class="string">FileFormat =&gt;</span> wdFormatDocument&#125;);</span><br><span class="line">    <span class="variable">$document</span>-&gt;Close(); </span><br><span class="line">    <span class="variable">$word</span>-&gt;quit;         </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;公司分配了个工作，将某网站上所有专家的文章复制下来，如果手工操作，花时间不说，而且枯燥折磨人，于是用Web::Scraper写个爬虫，从网页中抓取内容并将内容写进word文档。&lt;br&gt;
    
    </summary>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/categories/perl/"/>
    
    
      <category term="Web::Scraper" scheme="https://github.com/tianyv/tianyv.github.io/tags/Web-Scraper/"/>
    
      <category term="Win32::OLE" scheme="https://github.com/tianyv/tianyv.github.io/tags/Win32-OLE/"/>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/tags/perl/"/>
    
      <category term="网页爬虫" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BD%91%E9%A1%B5%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>项目分布情况</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/07/16/xmfb/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/07/16/xmfb/</id>
    <published>2015-07-16T13:29:08.000Z</published>
    <updated>2015-12-03T14:06:10.868Z</updated>
    
    <content type="html"><![CDATA[<p>从2007年从事医院管理咨询，对参与并已结案的项目做了个统计。<br><a id="more"></a></p>
<p><img src="/img/xmfb.png" width="650"></p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">项目类型</th>
<th style="text-align:center">项目数</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">绩效管理</td>
<td style="text-align:center">34</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">定岗定编及流程管理</td>
<td style="text-align:center">11</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">合计</td>
<td style="text-align:center">45</td>
</tr>
</tbody>
</table>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;从2007年从事医院管理咨询，对参与并已结案的项目做了个统计。&lt;br&gt;
    
    </summary>
    
      <category term="项目分布" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E9%A1%B9%E7%9B%AE%E5%88%86%E5%B8%83/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="管理基础" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>科室收支核算</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/07/15/jxhs/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/07/15/jxhs/</id>
    <published>2015-07-15T06:46:11.000Z</published>
    <updated>2015-07-15T07:14:08.050Z</updated>
    
    <content type="html"><![CDATA[<p>科学的收支核算，是科室经营管理分析的基础，有了这个基础，可以建立科室成本谱和项目成本谱；同时可以作为科室年终评价的指标之一。<br><a id="more"></a></p>
<h2 id="一、核算报表">一、核算报表</h2><p><img src="/img/sjfx/02-1hsbb.png" width="650"></p>
<p>关键点：</p>
<ul>
<li>收费项目的合理归类</li>
<li>各项目核算比率的设定</li>
<li>平台科室手术室、ICU如何核算（绩效核算及成本核算要区别对待）</li>
</ul>
<h2 id="二、科室成本谱示例">二、科室成本谱示例</h2><p><img src="/img/sjfx/02-2kscbp.png" width="550"></p>
<h2 id="三、秩合比法科室年终评价">三、秩合比法科室年终评价</h2><p><img src="/img/sjfx/02-3gpxjy.png" width="550"></p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;科学的收支核算，是科室经营管理分析的基础，有了这个基础，可以建立科室成本谱和项目成本谱；同时可以作为科室年终评价的指标之一。&lt;br&gt;
    
    </summary>
    
      <category term="成本管理" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E6%88%90%E6%9C%AC%E7%AE%A1%E7%90%86/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>绩效水平现状分析</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/07/14/fxcj/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/07/14/fxcj/</id>
    <published>2015-07-14T14:23:51.000Z</published>
    <updated>2015-08-30T01:02:22.588Z</updated>
    
    <content type="html"><![CDATA[<p>绩效改革调研阶段主要是了解医院的绩效分配现状，通过可视化工具及数据统计分析方法，可以对医院各群体的绩效分配现状有个清晰的认识。<br><a id="more"></a></p>
<h2 id="一、临床科室各群体绩效分配差距">一、临床科室各群体绩效分配差距</h2><table>
<thead>
<tr>
<th>类型</th>
<th style="text-align:center">均值</th>
<th style="text-align:center">相对差距</th>
<th style="text-align:center">基尼系数</th>
</tr>
</thead>
<tbody>
<tr>
<td>医护</td>
<td style="text-align:center">2952</td>
<td style="text-align:center">0.86</td>
<td style="text-align:center">0.29</td>
</tr>
<tr>
<td>医生</td>
<td style="text-align:center">3426</td>
<td style="text-align:center">1.00</td>
<td style="text-align:center">0.28</td>
</tr>
<tr>
<td>护士</td>
<td style="text-align:center">2640</td>
<td style="text-align:center">0.77</td>
<td style="text-align:center">0.26</td>
</tr>
</tbody>
</table>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">医护分配差距合理1：0<span class="class">.77</span>；各群体内部分配差距不大，基尼系数不超0<span class="class">.35</span>。</span><br></pre></td></tr></table></figure>
<h2 id="二、临床科室各群体绩效分配现状">二、临床科室各群体绩效分配现状</h2><h3 id="2-1描述统计：">2.1描述统计：</h3><pre><code>[1] &quot;医生Summary:&quot;
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1100    2050    3400    3414    4700    6800 
[1] &quot;医生众数: N=4 T=51&quot;
[1] 2400</code></pre>
<pre><code>[1] &quot;技师Summary:&quot;
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1500    2200    2700    2540    2925    3700 
[1] &quot;技师众数: N=4 T=20&quot;
[1] 2700</code></pre>
<pre><code>[1] &quot;护士Summary:&quot;
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1000    1600    2700    2658    3200    5500 
[1] &quot;护士众数: N=10 T=77&quot;
[1] 3200</code></pre>
<pre><code>[1] &quot;科主任Summary:&quot;
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2000    3800    5100    5177    6400    8900 
[1] &quot;科主任众数: N=2 T=13&quot;
[1] 4000 7200</code></pre>
<pre><code>[1] &quot;护士长Summary:&quot;
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1800    2800    4600    4456    6100    7400 
[1] &quot;护士长众数: N=2 T=9&quot;
[1] 4600</code></pre>

<h3 id="2-2箱式图：">2.2箱式图：</h3><p><img src="/img/sjfx/01cjjx.png" width="550"></p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;绩效改革调研阶段主要是了解医院的绩效分配现状，通过可视化工具及数据统计分析方法，可以对医院各群体的绩效分配现状有个清晰的认识。&lt;br&gt;
    
    </summary>
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="数据分析" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>绩效改革重点：方案设计及员工观念的引导</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/07/10/jxgnyd/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/07/10/jxgnyd/</id>
    <published>2015-07-10T13:57:45.000Z</published>
    <updated>2015-12-11T02:15:18.794Z</updated>
    
    <content type="html"><![CDATA[<p>在从事咨询工作过程中，发现有些观念经常出现，如果这些错误认识在中层及领导班子中成为主流，将严重阻碍改革的推进和限制方案所能发挥的作用。<br><a id="more"></a></p>
<h2 id="对改革不利的观念：">对改革不利的观念：</h2><ul>
<li>1、绩效改革要以员工认可为前提，设计出科学、合理、有激励作用的方案</li>
<li>2、只要分配结果不合理，方案就不能实施，要继续完善</li>
<li>3、领导层把账算得很精，结果医院省了小钱，而员工却丧失了积极性</li>
<li>4、改革是顾问组的事，由老师负责制定方案，我们只需要按方案实施就行</li>
<li>5、临床科室业务工作忙，凡是绩效相关的事均是财务科的职责范围内的工作</li>
</ul>
<h4 id="1、绩效改革要以员工认可为前提，设计出科学、合理、有激励作用的方案">1、绩效改革要以员工认可为前提，设计出科学、合理、有激励作用的方案</h4><p>这种观念其实是本末倒置，在操作过程中，应该是基于绩效管理的原则，设计出符合医院战略导向，并且有激励作用的方案，同时保证方案的科学性与合理性，到此为此，其实只解决了技术层面的小问题；而改革过程中工作的重点与难点，更多地在于如何统一并转变员工的观念，如何消除员工的误解（当然也包括领导层的误解），以得到多数员工的认可与支持。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   员工心理上的“参照依赖”决定了改革不可能获得所有人的支持，因为改革打破了原有的分</span><br><span class="line">配排序，这也是即便方案再合理，试运行期间仍会有员工说这不合理那不合理的根本原因。</span><br><span class="line"></span><br><span class="line">参照依赖（多数人对得失的判断往往根据参照点决定）这一名词来源于前景理论。</span><br><span class="line">描述了如下心理现象：</span><br><span class="line">   1、其他人一年挣6万元你年收入7万元</span><br><span class="line">   2、其他人一年挣9万元你年收入8万元</span><br><span class="line">   多数人会选择第1项</span><br></pre></td></tr></table></figure>
<h4 id="2、只要分配结果不合理，方案就不能实施，要继续完善">2、只要分配结果不合理，方案就不能实施，要继续完善</h4><p>有些领导评判方案的合理与否，往往是在默认以往某些科室绩效水平排序合理的前提下，将其与改革后的分配结果进行比较，发现差异后就认为方案不合理，然后想方设法改变规则，将结果调整到合理的预期范围。这就好比一个医生，找不到病人发病的病因，只是根据表象就作出诊断，结果必然是头痛医头，脚痛医脚。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   要避免此类问题，首先是要了解方案的规则及设计的目的，同时审视老师所设计的规则的  </span><br><span class="line">合理性及适不适合医院，如果规则是公平合理的，结果不合理，那说明是科室出问题了（老师</span><br><span class="line">的原则是基于解决根本问题来设计的），不理解和认识到这一点，就容易造成误解，认为老师</span><br><span class="line">设计的方案不符合医院的实际情况。</span><br></pre></td></tr></table></figure>
<p>有时领导也认可老师设计的规则，但就是担心按这个结果推行下去，会因个别科室的结果引起其他科室的不满，既想弱化或解决这个顾虑，又想让员工树立起领导做事公平公正的形象，这时往往就会从规则的制高点上做文章，结果做出的决策往往是为了解决个体或局部问题而影响了全局的稳定。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   这就好比本来车头已经进入了轨道，只是车尾还在摇摆不定，这时又说退回去，要走另一</span><br><span class="line">条道，但两条道最终又都是达到同一终点，只是有人认为改道可能车尾就不会摆那么厉害了，</span><br><span class="line">而事实上可能车尾摇摆地同样厉害，而达到终点的路途可能更长，所花费时间也可能更长。</span><br></pre></td></tr></table></figure>
<p>作为有经验的咨询老师，往往会基于预防机制来设计分配规则，但员工会为了个人利益而提出不同意见，并且会说我们医院不会出现这种情况，所以这个规则在我们医院的分配方案中用不着体现。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   这也是错误的认识，健全的制度要以预防为主，而不是出了问题后再在原有制度上再加个</span><br><span class="line">补丁，特别是医疗行业共性的焦点性问题，更要有合理的机制来解决或避免这些问题的产生与</span><br><span class="line">恶化。</span><br></pre></td></tr></table></figure>
<h4 id="3、领导层把账算得很精，结果医院省了小钱，而员工却丧失了积极性">3、领导层把账算得很精，结果医院省了小钱，而员工却丧失了积极性</h4><ul>
<li>要全成本核算，所有的成本要科室承担，管理人员费用要分摊到各科室</li>
<li>要实行目标管理，给科室下增长指标，完不成要扣罚</li>
<li>有些公益性项目，医院收不回钱，不应给科室算工作量</li>
<li>以前绩效发得高了，要减下来</li>
<li>进修人员绩效工资由科室承担</li>
<li>轮转人员成本支出由科室承担</li>
</ul>
<h4 id="4、改革是顾问组的事，由老师负责制定方案，我们只需要按方案实施就行">4、改革是顾问组的事，由老师负责制定方案，我们只需要按方案实施就行</h4><p>领导及管理中层的作用不容忽视：<br>老师掌握的是理念与解决问题的方法，而医院领导比老师更了解医院的问题及实际情况，只有双方通力合作，才能更有效地解决问题；只有中层积极参与，才更容易获得他们的理解与支持，同时通过他们才能更有效地将老师的理念向员工传达下去；只有与员工充分的沟通交流，思想才能达成一致，避免产生不必要的误解。</p>
<p>财务科在改革过程中同样起着非常重要的作用：<br>首先，财务科主任及核算员充分理解老师设计的理念，同时转变自已固有的观念，或有不同意见时要及时与老师沟通，否则他们向领导层传播的可能是负面信息；在老师离开医院期间，向医院员工传达老师理念和解读方案时，能力强懂方法的可能对改革产生正面影响，方法不当时还可能起到负面影响。</p>
<h4 id="5、临床科室业务工作忙，凡是绩效相关的事均是财务科的职责范围内的工作">5、临床科室业务工作忙，凡是绩效相关的事均是财务科的职责范围内的工作</h4><p>改革前，科室往往提的意见是，收入支出是财务科算的，科室也无法核实对错；不了解医院的绩效工资是如何算出来的；科主任护士长无法调动员工积极性。<br>改革后，要求财务科提供收支核算报表，科室负责核对，有问题负责找信息科或财务科查找原因并解决问题；主导科室的二次分配，将二次分配及考核的权力给到科主任护士长。这时有些中层又会说科室业务忙，设法将工作往外推。</p>
<h2 id="后话">后话</h2><p>总之，员工的意志一旦成为主导，老师的观念与理念贯彻的就越少，方案与设计的初衷偏离地就越远，所起的作用也就越有限。</p>
<p>改革无易事，改革过程中是有矛盾的，不能回避矛盾，对于没有经验及能力的老师，经常犯以下错误，医院领导或科室提出异议，轻易放弃原则，根据领导或科室的意见进行调整，但作为负责任的老师，应该向领导层分析利弊，如果领导仍紧持自己的观点，那也只能以领导的决策为准，毕竟老师只有建议权而没有决策权。</p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在从事咨询工作过程中，发现有些观念经常出现，如果这些错误认识在中层及领导班子中成为主流，将严重阻碍改革的推进和限制方案所能发挥的作用。&lt;br&gt;
    
    </summary>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="管理基础" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>绩效改革推行原则和程序</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/06/26/jxgecx/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/06/26/jxgecx/</id>
    <published>2015-06-26T13:54:29.000Z</published>
    <updated>2015-07-10T14:42:38.089Z</updated>
    
    <content type="html"><![CDATA[<p>目的：希望管理高层能坚持原则，基于老师的合理建议做出决策，并及时向员工传达，同时保证领导班子的权威性，不随意更改决议。员工遵守改革纪律并严格按老师的改革流程操作。<br><a id="more"></a></p>
<h2 id="一、绩效改革推行原则">一、绩效改革推行原则</h2><p><img src="/img/jx/02-1yz.png" width="450"></p>
<h4 id="1-1增量改革">1.1增量改革</h4><ul>
<li>改革需要付出成本，不付出经济成本，就得付出政治成本（即改革失败的风险或损失）<ul>
<li>两害相权，取其轻，多数领导更愿意付出适当的改革成本来降低改革失败的风险</li>
</ul>
</li>
<li>经济成本主要用来解决以下两大问题<ul>
<li>解决以前不合理因素所带来的问题</li>
<li>重新建立规则，建立多劳多得、优劳优酬的机制</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">   绩效改革不仅仅是给大家涨绩效工资，也不仅仅是分配奖金这么简单；员工千万不要将焦点  </span><br><span class="line">放在哪个科室增的多了、谁谁谁又增的多了，而自已增的少了。</span><br></pre></td></tr></table></figure>
<h4 id="1-2领导作用">1.2领导作用</h4><p>老师行使建议权，领导行使决策权，了解和掌握老师所提出的原则及理念，完善决策准则的价值取向</p>
<ul>
<li>基于医院战略导向及老师的设计原则，敲定绩效分配方案的引导方向及框架<ul>
<li>掌握话语权，不受舆论的影响放弃原则;原因可见<a href="http://tianyv.github.io/2015/06/03/jxfp/" target="_blank" rel="external">“绩效分配模式”</a>第二点</li>
</ul>
</li>
<li>关注和重视改革，遵守集体决策的原则<ul>
<li>管理中层及普通员工私下找领导，个人不轻易作出承诺，更不轻易更改班子会上作出的决议</li>
</ul>
</li>
<li>一旦试运行，3个月内轻易不进行调整，保证政策的一致性，基于3个月试运行的数据进行分析后再作出适当调整<ul>
<li>异常高需下调的可以在试运行期随时调整，认为不合理需上调的坚持3个月，分析数据后再决定</li>
</ul>
</li>
<li>组织协调，做好分管科室员工的思想工作<ul>
<li>改革不只是院长和老师的事，改革是医院的重大工程，改革是整个决策层的共同承担的责任与义务</li>
</ul>
</li>
</ul>
<h4 id="1-3四个有利原则">1.3四个有利原则</h4><ul>
<li>有利于患者</li>
<li>有利于政府</li>
<li>有利于员工</li>
<li>有利于医院 </li>
</ul>
<h4 id="1-4基于事实决策的原则">1.4基于事实决策的原则</h4><p>方案参数的确定需经数据测算；方案需试运行3个月，再基于数据分析后作出调整  </p>
<p><img src="/img/jx/02-2syx.png" width="450"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">员工不的理解：</span><br><span class="line"></span><br><span class="line">1、为什么合理的要求提出来了，医院为什么不采纳并当月解决？</span><br><span class="line">   问题的解决与方案的调整是需要时间与程序的，意见即便有合理性，但不基于数据分析来做  </span><br><span class="line">决策，无法确定调整的幅度。</span><br><span class="line">   改革初期，员工往往对方案还一知半解，只是单纯地出于争取科室及个人利益为出发点，所  </span><br><span class="line">以到老师及领导那去争去吵（甚至有些员工认为自已不争不吵会吃亏，人家去吵了能得到好处）。  </span><br><span class="line">而老师的期望是希望科室及员工的关注点放在：</span><br><span class="line">   1）了解掌握收支核算规则和院级一次分配过程，明确方案的引导方向  </span><br><span class="line">   2）建立起公平合理的科室二次分配方案  </span><br><span class="line">   在信息不对称的情况下，特别是改革的敏感期，如果给个别科室提高了绩效工资，容易出现</span><br><span class="line">以下三个问题，反而阻碍改革的有序推进：</span><br><span class="line">   1）按下个葫芦起了个瓢，解决了个别问题引发更重大的问题，改革失控或引发其他群体的消  </span><br><span class="line">积和不满情绪</span><br><span class="line">   2）引起其他科室跟风，本来没意见的也来闹，反正闹了不提高也不吃亏，提高了就赚了，最  </span><br><span class="line">终分配规则无法建立起来</span><br><span class="line">   3）一旦提高，几个月运行后涨得过于厉害，导致新的不公平、不合理后，想再降下来就难了，  </span><br><span class="line">而采用行政手段降下来，马上会引起员工的抵触情绪，有些员工甚至会这样说领导，领导做事就  </span><br><span class="line">是看见谁低了就给提上去，看到我们高了，又把我们压下来，太儿戏了，太家用不着太努力，反正  </span><br><span class="line">高了最终还是得降下来</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2、试运行前两个月不调整，那第3个月调整后能否前2个月也按调整后的补回来？</span><br><span class="line">   一般不补，因为政策具有时效性，任何一个政策都是从形成决议后生效的。另外任何一个方案  </span><br><span class="line">都不可能保证长期运行而不作调整，那半年后或一年后有调整，是否之前的也要补回来呢，这肯定  </span><br><span class="line">不现实，这样财务科再多人也忙不过来。再说改革过程中，财务科的工作本身也加重很多，再加上  </span><br><span class="line">还要求核算员在3个月内掌握新方案的核算及分配方法，并且改革期间，还需随时准备和提供相关财  </span><br><span class="line">务数据，供班子作决策使用。</span><br></pre></td></tr></table></figure>
<h2 id="二、绩效改革推行程序">二、绩效改革推行程序</h2><p><img src="/img/jx/02-3cx.png" width="450"></p>
<h2 id="三、绩效改革的纪律">三、绩效改革的纪律</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   1、不能故意散播消极言论，无理不能取闹，有理也得守纪</span><br><span class="line">   2、向老师提意见建议可以，但不能提要求，更不能逼着要老师妥协（你不给我们调，我们就辞  </span><br><span class="line">职，我们就罢工）又或者（你今天就得帮我找院长解决，不解决就如何如何）</span><br><span class="line">   3、不能道听途说，所有信息以老师会上公布的为准</span><br><span class="line">   4、上班时间要反映问题，由主任或员工代表上来反映就可以了，不能集体上来找老师或院长，  </span><br><span class="line">而把病人丢在一边（因此引发事故科室和医院是要负全责的！）</span><br></pre></td></tr></table></figure>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;目的：希望管理高层能坚持原则，基于老师的合理建议做出决策，并及时向员工传达，同时保证领导班子的权威性，不随意更改决议。员工遵守改革纪律并严格按老师的改革流程操作。&lt;br&gt;
    
    </summary>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="管理基础" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>三种理论假设下的绩效管理</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/06/26/jxjs/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/06/26/jxjs/</id>
    <published>2015-06-26T10:09:52.000Z</published>
    <updated>2015-11-21T20:54:58.403Z</updated>
    
    <content type="html"><![CDATA[<p>刚从事绩效管理咨询时，当时的岗位是咨询助理，主要工作是协助老师的工作，做一些资料收集、数据整理分析工作，当时可能是刚从学校毕业的原因，学习的热情很高，工作之余，也在网上收集一些绩效管理的知识，当时看到了下文：<br><a id="more"></a><br><a href="http://wenku.baidu.com/view/4e3814ec551810a6f5248639.html" target="_blank" rel="external">能力导向？行为导向？还是结果导向？</a><br>现在以咨询师的视觉再回过头来看这篇文章，有感而发，根据医疗行业的特点发表一些自已的看法。</p>
<h2 id="一、结果绩效论：">一、结果绩效论：</h2><h4 id="1-1平衡积分卡">1.1平衡积分卡</h4><p>以<strong>基于平衡积分卡的关键指标考核方法</strong>为代表，经历了以单一财务指标（资产回报、成本、销售收入、利润等）发展到基于战略导向，同时关注学习成长、内部运营、顾客满意、财务结果的统一分配模式。<br>存在以下缺陷：  </p>
<ul>
<li>只关注结果，不关注过程，很可能导致结果最终受损</li>
<li>只追求短期利益或局部利益</li>
<li>外部环境变化战略做调整，分配指标未调整，组织丧失机遇或处于更加不利的地位</li>
<li>如果评价指标为主观指标，为了绩效弄虚做假，或者考核部分碍于人情，不严格落实考核</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">失败案例案例1： </span><br><span class="line"></span><br><span class="line">   美国安然公司，倡导的文化是赢者决定一切，诱使高级管理者在投资和会计程序方面冒很  </span><br><span class="line">大的风险，其结果就是虚报收入和隐瞒越来越多的债务，从而造成了一座用纸牌搭成的房子，  </span><br><span class="line">最后是企业的一夜间崩溃。</span><br><span class="line"></span><br><span class="line">失败案例案例2：  </span><br><span class="line">   绩效主义毁了索尼，链接如下：</span><br></pre></td></tr></table></figure>
<p><a href="http://www.360doc.com/content/07/1005/11/46707_789570.shtml" target="_blank" rel="external">绩效主义毁了索尼 http://www.360doc.com/content/07/1005/11/46707_789570.shtml</a></p>
<p>结果导向的绩效方法是否就不可取呢？也不尽然，关键是要知道这种理论的缺陷，通过配套机制杨其长避其短，以三星为例：<br><a href="http://baigang.baijia.baidu.com/article/18671" target="_blank" rel="external">为何绩效主义成就了三星，毁了索尼</a></p>
<h4 id="1-2MBO目标管理法">1.2MBO目标管理法</h4><p>这是一种<strong>基于预算为基础的目标管理法</strong>。<br>存在以下缺陷：</p>
<ul>
<li>预算管理只能以科室为管理单元，作为员工他认为个人多劳就应多得，而不应该因其他人少劳影响了科室绩效，未能充足地体现多得。</li>
<li>工作量和收入预算指标设定时很难有科学合理的方法去制定，一旦再与绩效挂钩，等于是管理高层在与全体员工博弈，最终可能屈于员工集体压力，以低标准设定指标告终，这样出现更不合理的结果，少劳不少得，多劳更不多得，优势生产力得不到释放。</li>
<li>医院业务科室的主任多为技术骨干，部分主任管理知识及经验欠缺，这也是采用目标管理很难出现效果的主要因素之一</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   其实目标管理更适用于管理者，而不适用于员工。因管理者掌握着人、财、物等资源，通  </span><br><span class="line">过对这些资源的合理配置，才能达到和实现管理目标，而目标的实现程度最终又由管理者的管  </span><br><span class="line">理经验和技能来决定。而做为执行者的管理中层，为了将目标落到实处，应将结果指标转换成  </span><br><span class="line">过程指标，而非简单地运用上级的结果指标来考核员工。</span><br></pre></td></tr></table></figure>
<h4 id="1-3EVA经济增加值法">1.3EVA经济增加值法</h4><p><strong>通过关注现金流来关注股东价值增值的方法</strong>，此种方法不适用于非营利性机构的医院。</p>
<h2 id="二、行为绩效">二、行为绩效</h2><p>通过对行为的观察来考核职责的履行情况，一是<strong>行为锚定等级评价法</strong>；二是<strong>行为观察量表法</strong>。<br>存在以下缺陷：</p>
<ul>
<li>缺乏科学、量化的方法</li>
<li>扼杀员工的创造性</li>
</ul>
<h2 id="三、技能与价值观绩效论">三、技能与价值观绩效论</h2><p>这种理论认为：与企业价值观一致性强的员工只要具备足够的技能，必然能产生对企业有益的行为，从而导致良好的绩效结果。   </p>
<ul>
<li>以<strong>360度考核法</strong>为代表,对企业高管的管理能力的，非奖惩性的绩效管理方式  </li>
<li><strong>胜任力评估</strong>，以构建素质模型库为基础的考核方式，其结果与常见的绩效奖金无关，而是直接体现到职业生涯规划上。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">此种理论适用于基层员工和事务性管理人员，如医院职能科室员工，但不适用于业务创造单元的员工。</span><br></pre></td></tr></table></figure>
<p>写这编文章，主要是为了说明，方法没有好坏，只有适合与不适合，而且不能只用单一的方法来设计绩效分配机制；管理者的激励要以结果为导向，业务单元员工要以过程为导向，事务性员工可结合技能与价值观绩效论。</p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;刚从事绩效管理咨询时，当时的岗位是咨询助理，主要工作是协助老师的工作，做一些资料收集、数据整理分析工作，当时可能是刚从学校毕业的原因，学习的热情很高，工作之余，也在网上收集一些绩效管理的知识，当时看到了下文：&lt;br&gt;
    
    </summary>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/categories/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
    
      <category term="医疗行业" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E5%8C%BB%E7%96%97%E8%A1%8C%E4%B8%9A/"/>
    
      <category term="管理咨询" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%92%A8%E8%AF%A2/"/>
    
      <category term="管理基础" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/"/>
    
      <category term="绩效管理" scheme="https://github.com/tianyv/tianyv.github.io/tags/%E7%BB%A9%E6%95%88%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Moose入门基础</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/06/15/moosejc/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/06/15/moosejc/</id>
    <published>2015-06-15T15:17:07.000Z</published>
    <updated>2015-06-26T13:40:42.044Z</updated>
    
    <content type="html"><![CDATA[<p>本文最早发布在chinaunix.net论坛及本人chinaunix.net博客。<br><a href="http://bbs.chinaunix.net/thread-4148453-1-1.html" target="_blank" rel="external">论坛 http://bbs.chinaunix.net/thread-4148453-1-1.html</a><br><a href="http://blog.chinaunix.net/uid-22674875-id-4383545.html" target="_blank" rel="external">博客 http://blog.chinaunix.net/uid-22674875-id-4383545.html</a><br><a id="more"></a></p>
<p>如下网上找到关于Moose使用的一个例子，刚接触感觉像天书，网上google一番，看了些资料终于搞明白了。现将整个理解过程简要列一下，希望对大家学Moose有帮助。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">package</span> Point;</span><br><span class="line">    <span class="keyword">use</span> Moose;</span><br><span class="line"></span><br><span class="line">    has <span class="string">'x'</span> =&gt; ( <span class="string">isa =&gt;</span> <span class="string">'Int'</span>, <span class="string">is =&gt;</span> <span class="string">'rw'</span> );</span><br><span class="line">    has <span class="string">'y'</span> =&gt; ( <span class="string">isa =&gt;</span> <span class="string">'Int'</span>, <span class="string">is =&gt;</span> <span class="string">'rw'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">use</span> Moose::Util::TypeConstraints;</span><br><span class="line">    subtype <span class="string">'Point::OrHashRef'</span>, as <span class="string">'Point'</span>;</span><br><span class="line">    coerce <span class="string">'Point::OrHashRef'</span>,</span><br><span class="line">      from <span class="string">'HashRef'</span>,</span><br><span class="line">      via &#123; Point-&gt;new( <span class="string">x =&gt;</span> <span class="variable">$_</span>-&gt;&#123;x&#125;, <span class="string">y =&gt;</span> <span class="variable">$_</span>-&gt;&#123;y&#125; ) &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="sub"><span class="keyword">sub</span> distance &#123;</span></span><br><span class="line">        <span class="keyword">my</span> <span class="variable">$start</span> = <span class="keyword">shift</span>;</span><br><span class="line">        <span class="keyword">my</span> <span class="variable">$end</span>   = <span class="keyword">shift</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">my</span> <span class="variable">$dx</span> = <span class="variable">$end</span>-&gt;<span class="keyword">x</span> - <span class="variable">$start</span>-&gt;<span class="keyword">x</span>;</span><br><span class="line">        <span class="keyword">my</span> <span class="variable">$dy</span> = <span class="variable">$end</span>-&gt;<span class="keyword">y</span> - <span class="variable">$start</span>-&gt;<span class="keyword">y</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">sqrt</span>( <span class="variable">$dx</span> * <span class="variable">$dx</span> + <span class="variable">$dy</span> * <span class="variable">$dy</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">package</span> Line;</span><br><span class="line">    <span class="keyword">use</span> Moose;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># And the same for end</span></span><br><span class="line">    has [ <span class="string">'start'</span>, <span class="string">'end'</span> ] =&gt; (</span><br><span class="line">        <span class="string">isa      =&gt;</span> <span class="string">'Point::OrHashRef'</span>,</span><br><span class="line">        <span class="string">coerce   =&gt;</span> <span class="number">1</span>,</span><br><span class="line">        <span class="string">is       =&gt;</span> <span class="string">'rw'</span>,</span><br><span class="line">        <span class="string">required =&gt;</span> <span class="number">1</span>,</span><br><span class="line">        <span class="string">trigger  =&gt;</span> <span class="sub"><span class="keyword">sub</span> &#123;</span></span><br><span class="line">            <span class="variable">$_</span>[<span class="number">0</span>]-&gt;_clear_length();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    has <span class="string">'length'</span> =&gt; (</span><br><span class="line">        <span class="string">isa     =&gt;</span> <span class="string">'Num'</span>,</span><br><span class="line">        <span class="string">is      =&gt;</span> <span class="string">'ro'</span>,</span><br><span class="line">        <span class="string">clearer =&gt;</span> <span class="string">'_clear_length'</span>,</span><br><span class="line">        <span class="string">lazy    =&gt;</span> <span class="number">1</span>,</span><br><span class="line">        <span class="string">default =&gt;</span> <span class="sub"><span class="keyword">sub</span> &#123;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$_</span>[<span class="number">0</span>]-&gt;start-&gt;distance( <span class="variable">$_</span>[<span class="number">0</span>]-&gt;end );</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> Test::More;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$line</span> = Line-&gt;new(</span><br><span class="line">    <span class="string">start =&gt;</span> &#123; <span class="string">x           =&gt;</span> <span class="number">1</span>, <span class="string">y =&gt;</span> <span class="number">1</span> &#125;,</span><br><span class="line">    <span class="string">end   =&gt;</span> Point-&gt;new( <span class="string">x =&gt;</span> <span class="number">2</span>, <span class="string">y =&gt;</span> <span class="number">2</span> )</span><br><span class="line">);</span><br><span class="line">isa_ok <span class="variable">$line</span>, <span class="string">"Line"</span>;</span><br><span class="line">isa_ok <span class="variable">$line</span>-&gt;start, <span class="string">"Point"</span>;</span><br><span class="line">isa_ok <span class="variable">$line</span>-&gt;end,   <span class="string">"Point"</span>;</span><br><span class="line">like <span class="variable">$line</span>-&gt;<span class="keyword">length</span>,  <span class="regexp">qr/^1.4142135623731/</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$line</span>-&gt;end( &#123; <span class="string">x =&gt;</span> <span class="number">3</span>, <span class="string">y =&gt;</span> <span class="number">3</span> &#125; );</span><br><span class="line">like <span class="variable">$line</span>-&gt;<span class="keyword">length</span>, <span class="regexp">qr/^2.82842712474619/</span>, <span class="string">"length is rederived"</span>;</span><br><span class="line"></span><br><span class="line">done_testing;</span><br></pre></td></tr></table></figure>
<p>一、弄懂distance函数是如何实现计算两点间的距离的。<br>1.1将代码简化为：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Point;</span><br><span class="line"><span class="keyword">use</span> Moose;</span><br><span class="line"></span><br><span class="line">has <span class="string">'x'</span> =&gt; ( <span class="string">isa =&gt;</span> <span class="string">'Int'</span>, <span class="string">is =&gt;</span> <span class="string">'rw'</span> );</span><br><span class="line">has <span class="string">'y'</span> =&gt; ( <span class="string">isa =&gt;</span> <span class="string">'Int'</span>, <span class="string">is =&gt;</span> <span class="string">'rw'</span> );</span><br><span class="line"></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> distance &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$_</span>, <span class="variable">$p</span> ) = <span class="variable">@_</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#对应例子$p1-&gt;distance($p2);</span></span><br><span class="line">    <span class="comment">#$_-&gt;&#123;x&#125;即$p1 = Point-&gt;new( x =&gt; 4, ... );</span></span><br><span class="line">    <span class="comment">#$p-&gt;&#123;x&#125;即$p2 = Point-&gt;new( x =&gt; 1, ... );</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$dx</span>, <span class="variable">$dy</span> ) = ( <span class="variable">$_</span>-&gt;&#123;x&#125; - <span class="variable">$p</span>-&gt;&#123;x&#125;, <span class="variable">$_</span>-&gt;&#123;y&#125; - <span class="variable">$p</span>-&gt;&#123;y&#125; );</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">sqrt</span>( <span class="variable">$dx</span> * <span class="variable">$dx</span> + <span class="variable">$dy</span> * <span class="variable">$dy</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$p1</span> = Point-&gt;new( <span class="string">x =&gt;</span> <span class="number">4</span>, <span class="string">y =&gt;</span> <span class="number">5</span> );</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$p2</span> = Point-&gt;new( <span class="string">x =&gt;</span> <span class="number">1</span>, <span class="string">y =&gt;</span> <span class="number">1</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'p1与p2相距距离为：'</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="variable">$p1</span>-&gt;distance(<span class="variable">$p2</span>);</span><br></pre></td></tr></table></figure>
<p>1.2将Moose实现的代码转化为传统OO辅助理解（同为网上找到的例子）：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="sub"><span class="keyword">sub</span> Point::new &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$class</span>, <span class="variable">$x</span>, <span class="variable">$y</span> ) = <span class="variable">@_</span>;</span><br><span class="line">    <span class="keyword">bless</span> [ <span class="variable">$x</span>, <span class="variable">$y</span> ], <span class="variable">$class</span>;    <span class="comment"># Implicit return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="sub"><span class="keyword">sub</span> Point::distance &#123;</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$self</span>, <span class="variable">$from</span> ) = <span class="variable">@_</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#对应例子$p1-&gt;distance($p2);</span></span><br><span class="line">    <span class="comment">#对于传统OO的实现，$self代表$p1,$self[0]即“bless [$x, $y],</span></span><br><span class="line">    <span class="comment">#$class”中的$x这不难理解了吧，同理$from即传入的$p2。</span></span><br><span class="line">    <span class="keyword">my</span> ( <span class="variable">$dx</span>, <span class="variable">$dy</span> ) = ( <span class="variable">$self</span>[<span class="number">0</span>] - <span class="variable">$from</span>[<span class="number">0</span>], <span class="variable">$self</span>[<span class="number">1</span>] - <span class="variable">$from</span>[<span class="number">1</span>] );</span><br><span class="line">    <span class="keyword">sqrt</span>( <span class="variable">$dx</span> * <span class="variable">$dx</span> + <span class="variable">$dy</span> * <span class="variable">$dy</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">$p1</span> = Point-&gt;new( <span class="number">4</span>, <span class="number">5</span> );</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$p2</span> = Point-&gt;new( <span class="number">1</span>, <span class="number">1</span> );</span><br><span class="line"><span class="keyword">print</span> <span class="variable">$p1</span>-&gt;distance(<span class="variable">$p2</span>);</span><br></pre></td></tr></table></figure>
<p>至此，Line类中length默认值$<em>[0]-&gt;start-&gt;distance( $</em>[0]-&gt;end )即为上例\$p1-&gt;distance(\$p2)。</p>
<p>2.1弄明白Moose是如何实现自定义类型，并如何强制实现类型转换的。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Point;</span><br><span class="line"><span class="keyword">use</span> Moose;</span><br><span class="line">has <span class="string">'x'</span> =&gt; ( <span class="string">isa =&gt;</span> <span class="string">'Int'</span>, <span class="string">is =&gt;</span> <span class="string">'rw'</span> );</span><br><span class="line">has <span class="string">'y'</span> =&gt; ( <span class="string">isa =&gt;</span> <span class="string">'Int'</span>, <span class="string">is =&gt;</span> <span class="string">'rw'</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">#对于new(start =&gt; &#123; x =&gt; 1, y =&gt; 1 &#125;,...)函数，我们传给第一个属性的值是个hash引用</span></span><br><span class="line"><span class="comment">#但测试输出ok 1 - The object isa Point，转变为了Point对象类型。</span></span><br><span class="line"><span class="keyword">use</span> Moose::Util::TypeConstraints;</span><br><span class="line"></span><br><span class="line"><span class="comment">#自定义既可以是Point对象类型又可以是HashRef的数据类型，并命名为Point::OrHashRef</span></span><br><span class="line">subtype <span class="string">'Point::OrHashRef'</span>, as <span class="string">'Point'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#将hash引用($hash=&#123; x =&gt; 1, y =&gt; 1 &#125;)强制转换成Point对象，通过Point-&gt;new()来实现，$_-&gt;&#123;x&#125;即$hash-&gt;&#123;x&#125;</span></span><br><span class="line">coerce <span class="string">'Point::OrHashRef'</span>,</span><br><span class="line">  from <span class="string">'HashRef'</span>,</span><br><span class="line">  via &#123; Point-&gt;new( <span class="string">x =&gt;</span> <span class="variable">$_</span>-&gt;&#123;x&#125;, <span class="string">y =&gt;</span> <span class="variable">$_</span>-&gt;&#123;y&#125; ) &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> Line;</span><br><span class="line"><span class="keyword">use</span> Moose;</span><br><span class="line"></span><br><span class="line">has [ <span class="string">'start'</span>, <span class="string">'end'</span> ] =&gt; (</span><br><span class="line">    <span class="string">isa    =&gt;</span> <span class="string">'Point::OrHashRef'</span>,</span><br><span class="line">    <span class="string">coerce =&gt;</span> <span class="number">1</span>,</span><br><span class="line">    <span class="string">is     =&gt;</span> <span class="string">'rw'</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main;</span><br><span class="line"><span class="keyword">use</span> Test::More;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">$line</span> = Line-&gt;new(</span><br><span class="line">    <span class="string">start =&gt;</span> &#123; <span class="string">x           =&gt;</span> <span class="number">1</span>, <span class="string">y =&gt;</span> <span class="number">1</span> &#125;,</span><br><span class="line">    <span class="string">end   =&gt;</span> Point-&gt;new( <span class="string">x =&gt;</span> <span class="number">2</span>, <span class="string">y =&gt;</span> <span class="number">2</span> )</span><br><span class="line">);</span><br><span class="line">isa_ok <span class="variable">$line</span>-&gt;start, <span class="string">"Point"</span>;</span><br><span class="line">isa_ok <span class="variable">$line</span>-&gt;end,   <span class="string">"Point"</span>;</span><br></pre></td></tr></table></figure>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本文最早发布在chinaunix.net论坛及本人chinaunix.net博客。&lt;br&gt;&lt;a href=&quot;http://bbs.chinaunix.net/thread-4148453-1-1.html&quot;&gt;论坛 http://bbs.chinaunix.net/thread-4148453-1-1.html&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.chinaunix.net/uid-22674875-id-4383545.html&quot;&gt;博客 http://blog.chinaunix.net/uid-22674875-id-4383545.html&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/categories/perl/"/>
    
    
      <category term="Moose" scheme="https://github.com/tianyv/tianyv.github.io/tags/Moose/"/>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/tags/perl/"/>
    
  </entry>
  
  <entry>
    <title>Schwartzian转换</title>
    <link href="https://github.com/tianyv/tianyv.github.io/2015/06/15/schwarzian/"/>
    <id>https://github.com/tianyv/tianyv.github.io/2015/06/15/schwarzian/</id>
    <published>2015-06-15T15:01:31.000Z</published>
    <updated>2015-08-06T07:18:53.973Z</updated>
    
    <content type="html"><![CDATA[<p>Schwartzian：map sort map组合应用</p>
<a id="more"></a>
<h2 id="Schwartzian_Example">Schwartzian Example</h2><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> Modern::Perl;</span><br><span class="line"><span class="keyword">use</span> Data::Dumper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> <span class="variable">@arr</span> = <span class="string">qw(a b c c 2 2)</span>;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">%count</span>;</span><br><span class="line"><span class="comment">#元素第1次出现的下标</span></span><br><span class="line"><span class="keyword">my</span> <span class="variable">%hash</span> = <span class="keyword">map</span> &#123; <span class="variable">$arr</span>[<span class="variable">$_</span>], <span class="variable">$_</span> &#125; <span class="number">0</span> .. <span class="variable">$#arr</span>;</span><br><span class="line"><span class="keyword">print</span> Dumper( \<span class="variable">%hash</span> );</span><br><span class="line"><span class="comment">#Schwartzian</span></span><br><span class="line"><span class="keyword">my</span> <span class="variable">@dates</span> = <span class="string">qw(2001/1/1  2001/07/04  1999/12/25)</span>;</span><br><span class="line"><span class="keyword">my</span> <span class="variable">@sorted</span> = <span class="keyword">map</span> &#123; <span class="variable">$_</span>-&gt;[<span class="number">0</span>] &#125;</span><br><span class="line">  <span class="keyword">sort</span> &#123; <span class="variable">$a</span>-&gt;[<span class="number">1</span>] &lt;=&gt; <span class="variable">$b</span>-&gt;[<span class="number">1</span>] </span><br><span class="line">      <span class="keyword">or</span> <span class="variable">$a</span>-&gt;[<span class="number">2</span>] &lt;=&gt; <span class="variable">$b</span>-&gt;[<span class="number">2</span>] </span><br><span class="line">      <span class="keyword">or</span> <span class="variable">$a</span>-&gt;[<span class="number">3</span>] &lt;=&gt; <span class="variable">$b</span>-&gt;[<span class="number">3</span>] &#125;</span><br><span class="line"><span class="keyword">map</span> &#123; [ <span class="variable">$_</span>, ( <span class="keyword">split</span> <span class="regexp">/\//</span>, <span class="variable">$_</span> ) ] &#125; <span class="variable">@dates</span>;</span><br><span class="line"><span class="keyword">print</span> Dumper( \<span class="variable">@sorted</span> );</span><br></pre></td></tr></table></figure>
<p><img src="/img/perl/01map.png" width="450"></p>
<p>注：上例为本人系列教程<strong>《Perl Simple 教程》</strong>其中一页幻灯片内容。</p>
<p>转载请注明：<br>原作者：赖韬(咨询师)<br>文章出处：<a href="http://tianyv.github.io" target="_blank" rel="external">http://tianyv.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Schwartzian：map sort map组合应用&lt;/p&gt;
    
    </summary>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/categories/perl/"/>
    
    
      <category term="map" scheme="https://github.com/tianyv/tianyv.github.io/tags/map/"/>
    
      <category term="perl" scheme="https://github.com/tianyv/tianyv.github.io/tags/perl/"/>
    
      <category term="schwarzian" scheme="https://github.com/tianyv/tianyv.github.io/tags/schwarzian/"/>
    
  </entry>
  
</feed>
